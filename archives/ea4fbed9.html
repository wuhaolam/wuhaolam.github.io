<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0"><title>进程和计划任务 | 穿着草鞋前往</title><meta name="author" content="Wu Hao"><meta name="copyright" content="Wu Hao"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="相关系统资源的查看命令和计划任务的使用"><link rel="shortcut icon" href="/img/image.jpg"><link rel="canonical" href="https://wuhaolam.github.io/archives/ea4fbed9.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="baidu-site-verification" content="code-sPKc2fWStl"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":300},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: true,
    post: true
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#1f1f1f","position":"bottom-left"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  }
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '进程和计划任务',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-07-06 16:20:49'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
    win.getCSS = url => new Promise((resolve, reject) => {
      const link = document.createElement('link')
      link.rel = 'stylesheet'
      link.href = url
      link.onload = () => resolve()
      link.onerror = () => reject()
      document.head.appendChild(link)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="/css/style.css"><meta name="generator" content="Hexo 5.4.2"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://cdn.jsdelivr.net/gh/wuhaolam/picgo_demo/img/%E5%A4%B4%E5%83%8F.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">29</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">8</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">8</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw fa fa-heartbeat"></i><span> 清单</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fas fa-images"></i><span> 照片</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/./img/index1.jpg')"><nav id="nav"><span id="blog-info"><a href="/" title="穿着草鞋前往"><span class="site-name">穿着草鞋前往</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw fa fa-heartbeat"></i><span> 清单</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fas fa-images"></i><span> 照片</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">进程和计划任务</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-11-24T00:15:00.000Z" title="发表于 2022-11-24 08:15:00">2022-11-24</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2023-07-06T08:20:49.241Z" title="更新于 2023-07-06 16:20:49">2023-07-06</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Linux%E5%9F%BA%E7%A1%80/">Linux基础</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="进程和计划任务"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="一、进程和内存管理"><a href="#一、进程和内存管理" class="headerlink" title="一、进程和内存管理"></a>一、进程和内存管理</h1><p>内核作用：进程管理、内存管理、文件管理、驱动管理、网络管理等</p>
<h2 id="1-1-什么是进程"><a href="#1-1-什么是进程" class="headerlink" title="1.1 什么是进程"></a>1.1 什么是进程</h2><p>Process：运行中的程序的一个副本，是被载入内存的一个指令集合，是资源分配的单位</p>
<ul>
<li>进程 ID 用来标记各个进程</li>
<li>UID、GID 和SELinux语境决定对文件系统的存取和访问权限</li>
<li>通常从执行进程的用户来继承</li>
<li>存在声明周期</li>
</ul>
<p>进程的创建：</p>
<ul>
<li>init：第一个进程，Centos7 之后为 systemd</li>
<li>进程：由父进程创建，fork() 出子进程，使用写时复制机制</li>
</ul>
<h2 id="1-2-进程、线程和携程"><a href="#1-2-进程、线程和携程" class="headerlink" title="1.2 进程、线程和携程"></a>1.2 进程、线程和携程</h2><h3 id="1-2-1-进程"><a href="#1-2-1-进程" class="headerlink" title="1.2.1 进程"></a>1.2.1 进程</h3><p>进程是计算机中的程序关于某数据集合上的一次运行活动，是系统进行资源分配和调度的基本单位，是操作系统结构的基础。</p>
<p>进程一般由程序、数据集合和程序控制块三部分组成</p>
<ul>
<li>程序用于描述进程要完成的功能，是控制进程执行的指令集</li>
<li>数据集合是程序在执行时所需要的数据和工作区</li>
<li>程序控制块(PCB)，包含进程的描述信息和控制信息，是进程存在的唯一标志</li>
</ul>
<p>进程具有的特征</p>
<ul>
<li>动态性：进程是程序的一次执行过程，是临时的，有生命周期的，是动态产生的，动态消亡的</li>
<li>并发性：任何进程都可以和其它进程一起并发执行</li>
<li>独立性：进程是系统进行资源分配和调度的一个独立单位</li>
<li>结构性：进程由程序、数据和进程控制块三部分组成</li>
</ul>
<h3 id="1-2-2-线程"><a href="#1-2-2-线程" class="headerlink" title="1.2.2 线程"></a>1.2.2 线程</h3><p>在操作系统早期没有现成的概念，进程是拥有资源和独立运行的最小单位，也是程序执行的最小单位。任务调度采用的是时间片轮转的抢占式调度方式，而进程是任务调度的最小单位，每个进程有各自独立的一块内存，使得各个进程之间内存地址相互隔离。</p>
<p>之后随着计算机的发展，对CPU的要求越来越高，进程之间的切换开销太大，无法满足越来越复杂的程序的要求，便出现了线程。</p>
<p>线程是程序执行中一个单一的顺序控制流程，是程序执行流的最小单位，是处理器调度和分派的基本单位。一个进程可以有一个或多个线程，各个线程之间共享程序的内存空间（即所在进程的内存空间）。一个标准的线程由线程ID、当前指令指针(PC)、寄存器和堆栈组成。而进程由内存空间（代码、数据、进程空间、打开的文件）和一个或多个线程组成。</p>
<h3 id="1-2-3-协程"><a href="#1-2-3-协程" class="headerlink" title="1.2.3 协程"></a>1.2.3 协程</h3><p>协程是一种基于线程之上，但比线程更加轻量级的存在，这种由程序员自己来管理的轻量级线程叫做——用户空间线程，具有对内核不可见的特性。</p>
<p>协程的特点</p>
<ul>
<li>线程的切换由操作系统负责调度，携程由用户自己进行调度，因此减少了上下文切换，提高了效率</li>
<li>线程的默认stack大小为1M，而协程更轻量，接近1K。因此可以在相同的内存中开启更多的协程</li>
<li>由于同一个线程上，因此可以避免竞争关系而使用锁</li>
<li>适用于被阻塞且需要大量并发的场景，但不适用于大量计算的多线程</li>
</ul>
<p><strong>进程与线程的区别</strong></p>
<ul>
<li>进程是程序执行的最小单位，而进程是操作系统分配资源的最小单位</li>
<li>一个进程由一个或多个线程组成，线程是一个进程中代码的不同执行路线</li>
<li>进程之间相互隔离，但同一进程下的各个线程之间共享程序的内存空间(包括代码段、数据集、堆等)及一些进程级别的资源(如打开的文件和信号)，某进程内的线程在其它进程不可见</li>
<li>线程的上下文切换比进程的上下文切换要快得多</li>
</ul>
<p>Question:  如何查看进程中的线程:question:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">1、pstree 命令,有&#123;&#125;的表示是该进程的线程</span><br><span class="line"><span class="comment"># 数字表示开启的线程的个数，也可加 -p 选项查看详细信息</span></span><br><span class="line">[root@wh-ctyun ~]<span class="comment"># pstree </span></span><br><span class="line">systemd─┬─NetworkManager─┬─dhclient</span><br><span class="line">        │                └─2*[&#123;NetworkManager&#125;]</span><br><span class="line">        ├─auditd───&#123;auditd&#125;</span><br><span class="line">        ├─crond</span><br><span class="line">        ├─dbus-daemon</span><br><span class="line">        ├─gssproxy───5*[&#123;gssproxy&#125;]</span><br><span class="line">        ├─haproxy-systemd───haproxy───haproxy</span><br><span class="line">        ├─login───bash</span><br><span class="line">        ├─master─┬─pickup</span><br><span class="line">        │        └─qmgr</span><br><span class="line">        ├─mysqld_safe───mysqld───18*[&#123;mysqld&#125;]</span><br><span class="line">        ├─polkitd───6*[&#123;polkitd&#125;]</span><br><span class="line">        ├─qemu-ga</span><br><span class="line">        ├─redis-server───2*[&#123;redis-server&#125;]</span><br><span class="line">        ├─rpcbind</span><br><span class="line">        ├─rsyslogd───3*[&#123;rsyslogd&#125;]</span><br><span class="line">        ├─sshd───sshd───bash───pstree</span><br><span class="line">        ├─systemd-journal</span><br><span class="line">        ├─systemd-logind</span><br><span class="line">        ├─systemd-udevd</span><br><span class="line">        ├─tuned───4*[&#123;tuned&#125;]</span><br><span class="line">        └─wrapper─┬─java───13*[&#123;java&#125;]</span><br><span class="line">                  └─&#123;wrapper&#125;</span><br><span class="line">                  </span><br><span class="line">2、直接查看指定进程的文件</span><br><span class="line"><span class="comment"># 格式 grep -i threads /proc/PID/status</span></span><br><span class="line">[root@wh-ctyun ~]<span class="comment"># grep -i threads /proc/654/status </span></span><br><span class="line">Threads:	14</span><br></pre></td></tr></table></figure>

<h2 id="1-3-进程优先级"><a href="#1-3-进程优先级" class="headerlink" title="1.3 进程优先级"></a>1.3 进程优先级</h2><p><img src="https://cdn.jsdelivr.net/gh/wuhaolam/picgo_demo/img/image-20221202090922512.png" alt="image-20221202090922512"></p>
<h1 id="二、进程管理和性能相关工具"><a href="#二、进程管理和性能相关工具" class="headerlink" title="二、进程管理和性能相关工具"></a>二、进程管理和性能相关工具</h1><h2 id="2-1-进程树-pstree"><a href="#2-1-进程树-pstree" class="headerlink" title="2.1 进程树 pstree"></a>2.1 进程树 pstree</h2><p>pstree 用来显示进程的父子关系，以树型结构显示</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">pstree [option] [PID | USER]</span><br><span class="line"></span><br><span class="line">options:</span><br><span class="line">  -p    显示PID</span><br><span class="line">  -T    不显示线程thread，默认显示线程</span><br><span class="line">  -u    显示用户切换</span><br><span class="line">  -H pid    高亮显示指定进程及前辈进程</span><br></pre></td></tr></table></figure>

<p>示例</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">[root@Rocky8-mini ~]<span class="comment"># pstree</span></span><br><span class="line">systemd─┬─NetworkManager───2*[&#123;NetworkManager&#125;]</span><br><span class="line">        ├─VGAuthService</span><br><span class="line">        ├─agetty</span><br><span class="line">        ├─auditd───&#123;auditd&#125;</span><br><span class="line">        ├─chronyd</span><br><span class="line">        ├─crond</span><br><span class="line">        ├─dbus-daemon</span><br><span class="line">        ├─irqbalance───&#123;irqbalance&#125;</span><br><span class="line">        ├─polkitd───5*[&#123;polkitd&#125;]</span><br><span class="line">        ├─rsyslogd───2*[&#123;rsyslogd&#125;]</span><br><span class="line">        ├─sshd───sshd───sshd───bash───pstree</span><br><span class="line">        ├─sssd─┬─sssd_be</span><br><span class="line">        │      └─sssd_nss</span><br><span class="line">        ├─systemd───(sd-pam)</span><br><span class="line">        ├─systemd-journal</span><br><span class="line">        ├─systemd-logind</span><br><span class="line">        ├─systemd-udevd</span><br><span class="line">        ├─tuned───5*[&#123;tuned&#125;]</span><br><span class="line">        └─vmtoolsd───2*[&#123;vmtoolsd&#125;]</span><br><span class="line">        </span><br><span class="line">[root@Rocky8-mini ~]<span class="comment"># su wh</span></span><br><span class="line">[wh@Rocky8-mini root]$ pstree -u</span><br><span class="line">systemd─┬─NetworkManager───2*[&#123;NetworkManager&#125;]</span><br><span class="line">        ├─VGAuthService</span><br><span class="line">        ├─agetty</span><br><span class="line">        ├─auditd───&#123;auditd&#125;</span><br><span class="line">        ├─chronyd(chrony)</span><br><span class="line">        ├─crond</span><br><span class="line">        ├─dbus-daemon(dbus)</span><br><span class="line">        ├─irqbalance───&#123;irqbalance&#125;</span><br><span class="line">        ├─polkitd(polkitd)───5*[&#123;polkitd&#125;]</span><br><span class="line">        ├─rsyslogd───2*[&#123;rsyslogd&#125;]</span><br><span class="line">        ├─sshd───sshd───sshd───bash───su───bash(wh)───pstree</span><br><span class="line">        ├─sssd─┬─sssd_be</span><br><span class="line">        │      └─sssd_nss</span><br><span class="line">        ├─systemd───(sd-pam)</span><br><span class="line">        ├─systemd-journal</span><br><span class="line">        ├─systemd-logind</span><br><span class="line">        ├─systemd-udevd</span><br><span class="line">        ├─tuned───5*[&#123;tuned&#125;]</span><br><span class="line">        └─vmtoolsd───2*[&#123;vmtoolsd&#125;]</span><br></pre></td></tr></table></figure>

<h2 id="2-2-进程信息-ps"><a href="#2-2-进程信息-ps" class="headerlink" title="2.2 进程信息 ps"></a>2.2 进程信息 ps</h2><p>ps 可以查看进程当前状态的信息，默认显示当前终端中的进程信息，Linux系统各进程的相关信息均保存在<code>/proc/PID</code>目录下的各文件中</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">ps [option] ...</span><br><span class="line"></span><br><span class="line">options:</span><br><span class="line">  a  显示所有终端中的进程</span><br><span class="line">  x  包括不链接终端中的进程</span><br><span class="line">  u  显示进程所有者的信息</span><br><span class="line">  f  显示进程树，相当于 --forest</span><br><span class="line">  k|--<span class="built_in">sort</span> 属性  对属性排序，属性前加 - 表示倒序</span><br><span class="line">  o 属性...  指定显示的信息，如 pid、cmd、%cpu、%mem</span><br><span class="line">  L  显示支持的属性列表</span><br><span class="line">  -C cmdlist  指定命令，多个命令用<span class="string">&#x27;,&#x27;</span>分隔</span><br><span class="line">  -L  显示线程</span><br><span class="line">  -e  显示所有进程，相当于-A</span><br><span class="line">  -f  显示完整格式程序信息</span><br><span class="line">  -F  显示更完整格式的进程信息</span><br><span class="line">  -H  以进程层级格式显示进程相关信息</span><br><span class="line">  -u userlist  指定有效的用户ID或名称</span><br><span class="line">  -U userlist  指定真正的用户ID或名称</span><br><span class="line">  -g gid或groupname  指定有效的gid或组名称</span><br><span class="line">  -G gid或groupname  指定真正的gid或组名称</span><br><span class="line">  -p pid  显示指定的pid的进程</span><br><span class="line">  --ppid pid  指定父进程的PID，显示属于父进程的子进程</span><br><span class="line">  -t ttylist  指定<span class="built_in">tty</span>，相当于 t</span><br><span class="line">  -M  显示selinux信息，相当于Z</span><br></pre></td></tr></table></figure>

<p>ps 输出属性</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">C: ps -ef  显示列C表示cpu的利用率</span><br><span class="line">VSZ: 虚拟内存集，线性内存</span><br><span class="line">RSS: 常驻内存集</span><br><span class="line">STAT: 进程状态</span><br><span class="line">  R: running</span><br><span class="line">  S: interruptable sleeping</span><br><span class="line">  D: uninterruptable sleeping</span><br><span class="line">  T: stopped</span><br><span class="line">  Z: zombie</span><br><span class="line">  +: 前台进程</span><br><span class="line">  l: 多线程进程</span><br><span class="line">  L: 内存分页并带锁</span><br><span class="line">  N: 低优先级进程</span><br><span class="line">  &lt;: 高优先级进程</span><br><span class="line">  s: session leader,会话发起者</span><br><span class="line">  I: Idle kernel thread, Centos8 新特性</span><br><span class="line">ni: <span class="built_in">nice</span> 值</span><br><span class="line">pri: priority</span><br><span class="line">rtprio: 实时优先级</span><br><span class="line">psr: processor  CPU编号</span><br></pre></td></tr></table></figure>

<p>​	</p>
<h2 id="2-3-查看进程信息-prtstat"><a href="#2-3-查看进程信息-prtstat" class="headerlink" title="2.3 查看进程信息 prtstat"></a>2.3 查看进程信息 prtstat</h2><p>显示进程信息，来自于psmisc包</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">prtstat [options] PID</span><br><span class="line">  -r  raw格式显示</span><br></pre></td></tr></table></figure>

<p>示例</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">[root@Rocky8-mini ~]<span class="comment"># prtstat -r 1846 </span></span><br><span class="line">         pid: 1846           	                  <span class="built_in">comm</span>: bash</span><br><span class="line">       state: S              	                  ppid: 1845</span><br><span class="line">        pgrp: 1846           	               session: 1846</span><br><span class="line">      tty_nr: 34816          	                 tpgid: 1875</span><br><span class="line">       flags: 404000         	                minflt: 1473</span><br><span class="line">     cminflt: 3065           	                majflt: 0</span><br><span class="line">     cmajflt: 5              	                 utime: 0</span><br><span class="line">       stime: 2              	                cutime: 0</span><br><span class="line">      cstime: 2              	              priority: 20</span><br><span class="line">        <span class="built_in">nice</span>: 0              	           num_threads: 1</span><br><span class="line"> itrealvalue: 0              	             starttime: 3410389</span><br><span class="line">       vsize: 27787264       	                   rss: 1227</span><br><span class="line">      rsslim: 18446744073709551615	             startcode: 94493703389184</span><br><span class="line">     endcode: 94493704468816 	            startstack: 140723809939296</span><br><span class="line">     kstkesp: 0              	               kstkeip: 0</span><br><span class="line">       wchan: 0              	                 nswap: 0</span><br><span class="line">      cnswap: 0              	           exit_signal: 17</span><br><span class="line">   processor: 1              	           rt_priority: 0</span><br><span class="line">      policy: 0              	 delayaccr_blkio_ticks: 0</span><br><span class="line">  guest_time: 0              	           cguest_time: 0</span><br></pre></td></tr></table></figure>

<h2 id="2-4-设置和调整进程优先级"><a href="#2-4-设置和调整进程优先级" class="headerlink" title="2.4 设置和调整进程优先级"></a>2.4 设置和调整进程优先级</h2><p>进程优先级调整</p>
<ul>
<li>静态优先级</li>
<li>进程默认启动时的nice值为0，优先级为120</li>
<li>只有根用户才能降低nice值（提高优先性）</li>
</ul>
<p>nice 命令：以指定的优先级来启动进程</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">nice</span> [OPTION] [COMMAND [ARG]...]</span><br><span class="line">-n, --adjustment=N  add <span class="built_in">integer</span> N to the niceness (default 10)</span><br></pre></td></tr></table></figure>

<p>renice 命令：调整正在执行中的进程的优先级</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">renice [-n] priority pid ...</span><br></pre></td></tr></table></figure>

<p>查看</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ps axo pid,<span class="built_in">comm</span>,ni</span><br></pre></td></tr></table></figure>

<p>示例</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@Rocky8-mini ~]<span class="comment"># nice -n -10 ping www.baidu.com</span></span><br><span class="line">[root@Rocky8-mini ~]<span class="comment"># ps axo pid,cmd,nice | grep ping</span></span><br><span class="line">   1944 ping www.baidu.com          -10</span><br><span class="line">   1946 grep --color=auto ping        0</span><br><span class="line">   </span><br><span class="line">[root@Rocky8-mini ~]<span class="comment"># renice -n -20 1944</span></span><br><span class="line">1944 (process ID) old priority -10, new priority -20</span><br><span class="line">[root@Rocky8-mini ~]<span class="comment"># ps axo pid,cmd,nice | grep ping</span></span><br><span class="line">   1944 ping www.baidu.com          -20</span><br><span class="line">   1950 grep --color=auto ping        0</span><br></pre></td></tr></table></figure>

<h2 id="2-5-搜索进程"><a href="#2-5-搜索进程" class="headerlink" title="2.5 搜索进程"></a>2.5 搜索进程</h2><p>按条件搜索进程</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(1) ps 选项 | grep <span class="string">&#x27;PATTERN&#x27;</span></span><br><span class="line">(2) pgrep  按预定义模式</span><br><span class="line">(3) /sbin/pidof  按确切的程序名称查看pid</span><br></pre></td></tr></table></figure>

<h3 id="2-5-1-pgrep"><a href="#2-5-1-pgrep" class="headerlink" title="2.5.1 pgrep"></a>2.5.1 pgrep</h3><p>格式</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">pgrep [options] pattern</span><br><span class="line"></span><br><span class="line">[options]</span><br><span class="line">  -u uid:  effective user </span><br><span class="line">  -U uid:  real user, 真正运行命令的发起者</span><br><span class="line">  -t terminal:  与指定终端相关的进程</span><br><span class="line">  -l:  显示进程名</span><br><span class="line">  -a:  显示完整格式的进程名</span><br><span class="line">  -P pid:  显示指定进程的子进程</span><br><span class="line">  </span><br><span class="line">pkill [options] pattern  杀死某个进程</span><br></pre></td></tr></table></figure>

<p>示例</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[root@Rocky8-mini ~]<span class="comment"># pgrep -l -u  wh</span></span><br><span class="line">1993 bash</span><br><span class="line">2020 ping</span><br><span class="line"></span><br><span class="line">[root@Rocky8-mini ~]<span class="comment"># pgrep -aP 1993</span></span><br><span class="line">2020 ping www.baidu.com</span><br><span class="line"></span><br><span class="line">[root@Rocky8-mini ~]<span class="comment"># pgrep -at pts/1</span></span><br><span class="line">1913 -bash</span><br><span class="line">1992 su wh</span><br><span class="line">1993 bash</span><br><span class="line">2020 ping www.baidu.com</span><br><span class="line"></span><br><span class="line"><span class="comment"># 杀死c1这个用户的进程</span></span><br><span class="line">pkill -u c1</span><br></pre></td></tr></table></figure>

<h3 id="2-5-2-pidof"><a href="#2-5-2-pidof" class="headerlink" title="2.5.2 pidof"></a>2.5.2 pidof</h3><p>格式</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pidof [options] [program [...]]</span><br><span class="line">  -x 按脚本名称查找pid</span><br></pre></td></tr></table></figure>

<p>示例</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@Rocky8-mini ~]<span class="comment"># pidof bash</span></span><br><span class="line">2034 1993 1913 1846</span><br></pre></td></tr></table></figure>

<h2 id="2-6-负载查询-uptime"><a href="#2-6-负载查询-uptime" class="headerlink" title="2.6 负载查询 uptime"></a>2.6 负载查询 uptime</h2><p>&#x2F;proc&#x2F;uptime 包括两个值，单位 s</p>
<ul>
<li>系统启动时长</li>
<li>空闲进程的总时长（按总的CPU核数计算）</li>
</ul>
<p>uptime 和 w 显示以下内容</p>
<ul>
<li>当前时间</li>
<li>系统已启动的时间</li>
<li>当前上线人数</li>
<li>系统平均负载（1、5、15分钟的平均负载，一般不会超过1，超过5时建议警报）</li>
</ul>
<p>系统平均负载：指在特定时间间隔内运行队列中的平均进程数，通常每个CPU内核的当前活动进程数不大于3，那么系统的性能良好。如果每个CPU内核的任务数大于5，那么此主机的性能有严重问题。</p>
<p>如：Linux主机是一个双核CPU，当 load average 为 6 的时候说明机器已经被充分使用</p>
<p>示例</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@Rocky8-mini ~]<span class="comment"># uptime</span></span><br><span class="line"> 09:49:24 up 10:06,  3 <span class="built_in">users</span>,  load average: 0.00, 0.00, 0.00</span><br><span class="line">[root@Rocky8-mini ~]<span class="comment"># w</span></span><br><span class="line"> 09:49:29 up 10:06,  3 <span class="built_in">users</span>,  load average: 0.00, 0.00, 0.00</span><br><span class="line">USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT</span><br><span class="line">root     pts/0    192.168.119.1    09:11    1.00s  0.10s  0.00s w</span><br><span class="line">root     pts/1    192.168.119.1    09:19   13:58   0.06s  0.02s bash</span><br><span class="line">root     pts/2    192.168.119.1    09:38    7:45   0.03s  0.03s -bash</span><br></pre></td></tr></table></figure>

<h2 id="2-7-显示CPU相关统计-mpstat"><a href="#2-7-显示CPU相关统计-mpstat" class="headerlink" title="2.7 显示CPU相关统计 mpstat"></a>2.7 显示CPU相关统计 mpstat</h2><p>来源sysstat包</p>
<p>示例</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">[root@Rocky8-mini ~]<span class="comment"># dnf -y install sysstat</span></span><br><span class="line"></span><br><span class="line">[root@Rocky8-mini ~]<span class="comment"># mpstat</span></span><br><span class="line">Linux 4.18.0-348.el8.0.2.x86_64 (Rocky8-mini) 	12/07/2022 	_x86_64_	(2 CPU)</span><br><span class="line"></span><br><span class="line">08:40:05 AM  CPU    %usr   %<span class="built_in">nice</span>    %sys %iowait    %irq   %soft  %steal  %guest  %gnice   %idle</span><br><span class="line">08:40:05 AM  all    0.01    0.00    0.07    0.00    0.04    0.04    0.00    0.00    0.00   99.84</span><br><span class="line"></span><br><span class="line"><span class="comment"># 每1秒显示一次结果，总共3次</span></span><br><span class="line">[root@Rocky8-mini ~]<span class="comment"># mpstat 1 3</span></span><br><span class="line">Linux 4.18.0-348.el8.0.2.x86_64 (Rocky8-mini) 	12/07/2022 	_x86_64_	(2 CPU)</span><br><span class="line"></span><br><span class="line">08:41:28 AM  CPU    %usr   %<span class="built_in">nice</span>    %sys %iowait    %irq   %soft  %steal  %guest  %gnice   %idle</span><br><span class="line">08:41:29 AM  all    4.10    0.00   13.11    0.00    0.00    0.82    0.00    0.00    0.00   81.97</span><br><span class="line">08:41:30 AM  all    6.11    0.00   17.56    0.00    0.00    0.00    0.00    0.00    0.00   76.34</span><br><span class="line">08:41:31 AM  all    4.17    0.00   12.50    0.00    0.00    0.00    0.00    0.00    0.00   83.33</span><br><span class="line">Average:     all    4.83    0.00   14.48    0.00    0.00    0.27    0.00    0.00    0.00   80.43</span><br></pre></td></tr></table></figure>

<h2 id="2-8-查看进程实时状态-top-和-htop"><a href="#2-8-查看进程实时状态-top-和-htop" class="headerlink" title="2.8 查看进程实时状态 top 和 htop"></a>2.8 查看进程实时状态 top 和 htop</h2><h3 id="2-8-1-top"><a href="#2-8-1-top" class="headerlink" title="2.8.1 top"></a>2.8.1 top</h3><p>top 提供动态的实时进程状态</p>
<p>top 提供的内置命令</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">帮助: h 或 ？, 按 q 或 esc 退出帮助</span><br><span class="line"></span><br><span class="line">排序</span><br><span class="line">  P: 以占据的CPU百分比, %CPU</span><br><span class="line">  M: 以内存占据的百分比, %MEM</span><br><span class="line">  T: CPU累积占用时长, TIME+</span><br><span class="line">  </span><br><span class="line">首部信息显示</span><br><span class="line">  <span class="built_in">uptime</span> 信息: l命令</span><br><span class="line">  tasks及CPU信息: t命令</span><br><span class="line">    CPU分别显示: 数字 1</span><br><span class="line">  memory信息: m命令</span><br><span class="line"></span><br><span class="line">退出命令: q</span><br><span class="line">修改刷新时间间隔: s</span><br><span class="line">终止指定进程: k</span><br></pre></td></tr></table></figure>

<p>top 展示的信息详解</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">[root@Rocky8-mini ~]<span class="comment"># top</span></span><br><span class="line"><span class="comment"># 当前top命令运行的时间 已经运行的时长 当前用户登录数 系统的负载均衡平均值: 最近1分钟 5分钟 15分钟</span></span><br><span class="line">top - 08:45:17 up 12:56,  2 <span class="built_in">users</span>,  load average: 0.09, 0.07, 0.02</span><br><span class="line"></span><br><span class="line"><span class="comment"># 当前系统总共的进程数 正在运行的进程数量 处于睡眠状态的 处于停止状态 处于僵死状态</span></span><br><span class="line">Tasks: 156 total,   1 running, 155 sleeping,   0 stopped,   0 zombie</span><br><span class="line"></span><br><span class="line"><span class="comment"># us：用户空间占用CPU百分比（Host.cpu.user）</span></span><br><span class="line"><span class="comment"># sy：内核空间占用CPU百分比（Host.cpu.system）</span></span><br><span class="line"><span class="comment"># ni：用户进程空间内改变过优先级的进程占用CPU百分比</span></span><br><span class="line"><span class="comment"># id：空闲CPU百分比（Host.cpu.idle）</span></span><br><span class="line"><span class="comment"># wa：等待输入输出的CPU时间百分比</span></span><br><span class="line"><span class="comment"># hi：硬件中断</span></span><br><span class="line"><span class="comment"># si：软件中断</span></span><br><span class="line"><span class="comment"># st：实时</span></span><br><span class="line">%Cpu(s):  0.0 us,  0.0 sy,  0.0 ni, 99.8 <span class="built_in">id</span>,  0.0 wa,  0.0 hi,  0.2 si,  0.0 st</span><br><span class="line"></span><br><span class="line"><span class="comment"># 总内存  空闲的内存  已使用的内存空间  缓冲区和缓存使用的空间    </span></span><br><span class="line">MiB Mem :   1790.3 total,   1156.8 free,    222.1 used,    411.4 buff/cache</span><br><span class="line"><span class="comment"># 总的交换空间  空闲的  已使用的  用于内核缓存的</span></span><br><span class="line">MiB Swap:   2048.0 total,   2048.0 free,      0.0 used.   1405.3 avail Mem </span><br><span class="line"></span><br><span class="line"><span class="comment"># PID 				进程号</span></span><br><span class="line"><span class="comment"># USER  			用户    </span></span><br><span class="line"><span class="comment"># PR  				优先级</span></span><br><span class="line"><span class="comment"># NI    			NICE值</span></span><br><span class="line"><span class="comment"># VIRT  			虚拟内存集</span></span><br><span class="line"><span class="comment"># RES   			常驻内存集</span></span><br><span class="line"><span class="comment"># SHR 				共享内存大小</span></span><br><span class="line"><span class="comment"># S 					状态</span></span><br><span class="line"><span class="comment"># %CPU 				CPU的占据百分比</span></span><br><span class="line"><span class="comment"># %MEM 				内存的占用百分比    </span></span><br><span class="line"><span class="comment"># TIME+				累计运行时长</span></span><br><span class="line"><span class="comment"># COMMAND			启动此进程的命令</span></span><br><span class="line">    PID USER      PR  NI    VIRT    RES    SHR S  %CPU  %MEM     TIME+ COMMAND                   </span><br></pre></td></tr></table></figure>

<p>top 选项</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">-d <span class="comment">#: 指定刷新时间间隔，默认为3秒；</span></span><br><span class="line">-b: 以批次方式；</span><br><span class="line">-n <span class="comment">#: 显示多少批次；</span></span><br><span class="line">-u: 只显示指定的进程</span><br><span class="line">-H: 线程模式</span><br></pre></td></tr></table></figure>

<p>示例</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">top -H -P `pidof mysqld`</span><br></pre></td></tr></table></figure>

<h3 id="2-8-2-htop"><a href="#2-8-2-htop" class="headerlink" title="2.8.2 htop"></a>2.8.2 htop</h3><p>选项</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">-d <span class="comment">#: 指定延迟时间</span></span><br><span class="line">-u UserName: 仅显示指定用户的进程</span><br><span class="line">-s COLOMN: 以指定字段进行排序</span><br></pre></td></tr></table></figure>

<p>子命令</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">s: 跟踪选定进程的系统调用；</span><br><span class="line">l: 显示选定进程打开的文件列表；</span><br><span class="line">a：将选定的进程绑定至某指定CPU核心；</span><br><span class="line">t: 显示进程树</span><br></pre></td></tr></table></figure>

<p>来自于epel源</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@Rocky8-mini ~]<span class="comment"># dnf -y install htop &amp;&gt; /dev/null;htop</span></span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/wuhaolam/picgo_demo/img/image-20221207224113036.png" alt="image-20221207224113036"></p>
<h2 id="2-9-内存空间-free"><a href="#2-9-内存空间-free" class="headerlink" title="2.9 内存空间 free"></a>2.9 内存空间 free</h2><p>free 可以显示内存空间使用状态</p>
<p>格式：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">free [option]</span><br><span class="line"></span><br><span class="line">常用选项</span><br><span class="line">-b      以Byte为单位</span><br><span class="line">-m      以MB为单位</span><br><span class="line">-g      以GB为单位</span><br><span class="line">-h      易读格式</span><br><span class="line">-o      不显示-/+buffers/cache行</span><br><span class="line">-t      显示 RAM+swap 的总和</span><br><span class="line">-s n    刷新间隔为n秒</span><br><span class="line">-C n    刷新n次后即退出</span><br></pre></td></tr></table></figure>

<p>示例：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@Rocky8-mini ~]<span class="comment"># free</span></span><br><span class="line">              total        used        free      shared  buff/cache   available</span><br><span class="line">Mem:        1833232      224152     1306820        8900      302260     1448232</span><br><span class="line">Swap:       2097148           0     2097148</span><br><span class="line">[root@Rocky8-mini ~]<span class="comment"># free -h</span></span><br><span class="line">              total        used        free      shared  buff/cache   available</span><br><span class="line">Mem:          1.7Gi       218Mi       1.2Gi       8.0Mi       295Mi       1.4Gi</span><br><span class="line">Swap:         2.0Gi          0B       2.0Gi</span><br></pre></td></tr></table></figure>

<p>关于缓存的清理</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">[root@Rocky8-mini ~]<span class="comment"># man proc</span></span><br><span class="line">···</span><br><span class="line">/proc/sys/vm/drop_caches (since Linux 2.6.16)</span><br><span class="line">Writing to this file causes the kernel to drop clean caches, dentries, and</span><br><span class="line">inodes from memory, causing that memory to become free. This can be useful <span class="keyword">for</span></span><br><span class="line">memory management testing and performing reproducible filesystem</span><br><span class="line">benchmarks.Because writing to this file causes the benefits of caching to be</span><br><span class="line">lost, it can degrade overall system performance.</span><br><span class="line">To free pagecache, use:</span><br><span class="line"><span class="built_in">echo</span> 1 &gt; /proc/sys/vm/drop_caches</span><br><span class="line">To free dentries and inodes, use:</span><br><span class="line"><span class="built_in">echo</span> 2 &gt; /proc/sys/vm/drop_caches</span><br><span class="line">To free pagecache, dentries and inodes, use:</span><br><span class="line"><span class="built_in">echo</span> 3 &gt; /proc/sys/vm/drop_caches</span><br><span class="line">Because writing to this file is a nondestructive operation and dirty objects</span><br><span class="line">are not freeable, the user should run <span class="built_in">sync</span>(1) first.</span><br></pre></td></tr></table></figure>

<h2 id="2-10-进程对应的内存映射-pmap"><a href="#2-10-进程对应的内存映射-pmap" class="headerlink" title="2.10 进程对应的内存映射 pmap"></a>2.10 进程对应的内存映射 pmap</h2><p>格式</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">pmap [options] pid [...]</span><br><span class="line">  -x: 显示详细格式信息</span><br><span class="line">  </span><br><span class="line">[root@Rocky8-mini ~]<span class="comment"># pmap 1</span></span><br><span class="line"><span class="comment"># cat /proc/PID/maps</span></span><br><span class="line">[root@Rocky8-mini ~]<span class="comment"># cat /proc/1/maps</span></span><br></pre></td></tr></table></figure>

<p>示例：关于系统调用和库调用的命令</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看系统调用</span></span><br><span class="line">[root@Rocky8-mini ~]<span class="comment"># dnf -y install strace</span></span><br><span class="line">[root@Rocky8-mini ~]<span class="comment"># strace ls</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看库调用</span></span><br><span class="line">[root@Rocky8-mini ~]<span class="comment"># dnf -y install ltrace</span></span><br><span class="line">[root@Rocky8-mini ~]<span class="comment"># ltrace ls</span></span><br></pre></td></tr></table></figure>

<h2 id="2-11-虚拟内存信息-vmstat"><a href="#2-11-虚拟内存信息-vmstat" class="headerlink" title="2.11 虚拟内存信息 vmstat"></a>2.11 虚拟内存信息 vmstat</h2><p>格式</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">vmstat [options] [delay [count]]</span><br><span class="line">  -s  显示内存的统计数据</span><br></pre></td></tr></table></figure>

<p>vmstat 显示项说明</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">procs:</span><br><span class="line">  r: 可运行（正运行或等待运行）进程的个数，和核心数有关</span><br><span class="line">  b: 处于不可中断睡眠态的进程个数（被阻塞的队列的长度）</span><br><span class="line">  </span><br><span class="line">memory:</span><br><span class="line">  swapd: 交换内存的使用总量</span><br><span class="line">  free:  空闲物理内存总量</span><br><span class="line">  buffer:  用于buffer的内存总量</span><br><span class="line">  cache:   用于cache的内存总量</span><br><span class="line"></span><br><span class="line">swap:</span><br><span class="line">  si:  从磁盘交换进内存的数据速率(kb/s)</span><br><span class="line">  so:  从内存交换至磁盘的数据速率(kb/s)</span><br><span class="line"><span class="comment"># if=/dev/zero of=/dev/null bs=2G</span></span><br><span class="line"><span class="comment"># 系统可用内存空间不足2G，当一次性读2G大小数据时会发生内存交换，内存会交换一部分数据# 到磁盘上的交换空间中，因此，so ↑</span></span><br><span class="line"></span><br><span class="line">io:</span><br><span class="line">  bi:  从块设备读入数据到系统的速率</span><br><span class="line">  bo:  保存数据至块设备的速率</span><br><span class="line"><span class="comment"># dd if=/dev/sda of=/dev/null</span></span><br><span class="line"><span class="comment"># 读磁盘数据，首先会加载到内存中，bi ↑</span></span><br><span class="line"></span><br><span class="line">system:</span><br><span class="line">  <span class="keyword">in</span>:  interrupts 中断速率，包括时钟</span><br><span class="line">  cs:  context switch 进程切换速率</span><br><span class="line"></span><br><span class="line">cpu:</span><br><span class="line">  us: Time spent running non-kernel code</span><br><span class="line">  sy: Time spent running kernel code</span><br><span class="line">  <span class="built_in">id</span>: Time spent idle. Linux 2.5.41前,包括IO-<span class="built_in">wait</span> time.</span><br><span class="line">  wa: Time spent waiting <span class="keyword">for</span> IO. 2.5.41前，包括<span class="keyword">in</span> idle.</span><br><span class="line">  st: Time stolen from a virtual machine. 2.6.11前, unknown.</span><br></pre></td></tr></table></figure>

<p>示例</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">[root@Rocky8-mini ~]<span class="comment"># vmstat</span></span><br><span class="line">procs -----------memory---------- ---swap-- -----io---- -system-- ------cpu-----</span><br><span class="line"> r  b   swpd   free   buff  cache   si   so    bi    bo   <span class="keyword">in</span>   cs us sy <span class="built_in">id</span> wa st</span><br><span class="line"> 2  0      0 1389468   4252 225424    0    0    43    10   47   90  0  0 100  0  0</span><br><span class="line">[root@Rocky8-mini ~]<span class="comment"># vmstat  1 3</span></span><br><span class="line">procs -----------memory---------- ---swap-- -----io---- -system-- ------cpu-----</span><br><span class="line"> r  b   swpd   free   buff  cache   si   so    bi    bo   <span class="keyword">in</span>   cs us sy <span class="built_in">id</span> wa st</span><br><span class="line"> 2  0      0 1389656   4252 225468    0    0    43    10   47   90  0  0 100  0  0</span><br><span class="line"> 0  0      0 1389468   4252 225468    0    0     0     0  106  150  0  0 99  0  0</span><br><span class="line"> 0  0      0 1389468   4252 225468    0    0     0     0   89  135  0  0 100  0  0</span><br><span class="line">[root@Rocky8-mini ~]<span class="comment"># vmstat -s</span></span><br><span class="line">      1833232 K total memory</span><br><span class="line">       213812 K used memory</span><br><span class="line">        81988 K active memory</span><br><span class="line">       164084 K inactive memory</span><br><span class="line">      1389708 K free memory</span><br><span class="line">         4252 K buffer memory</span><br><span class="line">       225460 K swap cache</span><br><span class="line">      2097148 K total swap</span><br><span class="line">            0 K used swap</span><br><span class="line">      2097148 K free swap</span><br><span class="line">          177 non-nice user cpu ticks</span><br><span class="line">            0 <span class="built_in">nice</span> user cpu ticks</span><br><span class="line">         1140 system cpu ticks</span><br><span class="line">       444917 idle cpu ticks</span><br><span class="line">           22 IO-<span class="built_in">wait</span> cpu ticks</span><br><span class="line">          357 IRQ cpu ticks</span><br><span class="line">          301 softirq cpu ticks</span><br><span class="line">            0 stolen cpu ticks</span><br><span class="line">       190362 pages paged <span class="keyword">in</span></span><br><span class="line">        42375 pages paged out</span><br><span class="line">            0 pages swapped <span class="keyword">in</span></span><br><span class="line">            0 pages swapped out</span><br><span class="line">       211123 interrupts</span><br><span class="line">       402441 CPU context switches</span><br><span class="line">   1671328052 boot time</span><br><span class="line">         1763 forks </span><br></pre></td></tr></table></figure>

<h2 id="2-12-统计CPU和设备IO信息-iostat"><a href="#2-12-统计CPU和设备IO信息-iostat" class="headerlink" title="2.12 统计CPU和设备IO信息 iostat"></a>2.12 统计CPU和设备IO信息 iostat</h2><p>iostat 提供更丰富的IO性能状态数据，由sysstat包提供</p>
<p>常用选项</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">-c  只显示CPU行</span><br><span class="line">-d  显示设备使用状态</span><br><span class="line">-k  以千字节为单位显示输出</span><br><span class="line">-t  在输出中包括时间戳</span><br><span class="line">-x  在输出中包括扩展的磁盘指标</span><br></pre></td></tr></table></figure>

<p>示例</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">[root@Rocky8-mini ~]<span class="comment"># iostat</span></span><br><span class="line">Linux 4.18.0-348.el8.0.2.x86_64 (Rocky8-mini) 	12/17/2022 	_x86_64_	(2 CPU)</span><br><span class="line"></span><br><span class="line">avg-cpu:  %user   %<span class="built_in">nice</span> %system %iowait  %steal   %idle</span><br><span class="line">           0.04    0.00    0.39    0.00    0.00   99.57</span><br><span class="line"></span><br><span class="line">Device             tps    kB_read/s    kB_wrtn/s    kB_read    kB_wrtn</span><br><span class="line">scd0              0.02         0.43         0.00       1041          0</span><br><span class="line">sdc               0.05         1.23         0.00       2992          0</span><br><span class="line">sdb               0.07         2.36         0.00       5727          2</span><br><span class="line">sda               2.67        74.41        17.47     180663      42422</span><br><span class="line">dm-0              2.44        50.91        16.61     123619      40325</span><br><span class="line">dm-1              0.04         0.91         0.00       2220          0</span><br><span class="line">dm-2              0.05         0.89         0.00       2169         12</span><br><span class="line"></span><br><span class="line">[root@Rocky8-mini ~]<span class="comment"># iostat 1 2</span></span><br><span class="line">Linux 4.18.0-348.el8.0.2.x86_64 (Rocky8-mini) 	12/17/2022 	_x86_64_	(2 CPU)</span><br><span class="line"></span><br><span class="line">avg-cpu:  %user   %<span class="built_in">nice</span> %system %iowait  %steal   %idle</span><br><span class="line">           0.04    0.00    0.39    0.00    0.00   99.57</span><br><span class="line"></span><br><span class="line">Device             tps    kB_read/s    kB_wrtn/s    kB_read    kB_wrtn</span><br><span class="line">scd0              0.02         0.42         0.00       1041          0</span><br><span class="line">sdc               0.04         1.21         0.00       2992          0</span><br><span class="line">sdb               0.07         2.32         0.00       5727          2</span><br><span class="line">sda               2.63        73.04        17.18     180671      42488</span><br><span class="line">dm-0              2.40        49.98        16.33     123627      40392</span><br><span class="line">dm-1              0.04         0.90         0.00       2220          0</span><br><span class="line">dm-2              0.04         0.88         0.00       2169         12</span><br><span class="line"></span><br><span class="line">avg-cpu:  %user   %<span class="built_in">nice</span> %system %iowait  %steal   %idle</span><br><span class="line">           0.00    0.00    0.00    0.00    0.00  100.00</span><br><span class="line"></span><br><span class="line">Device             tps    kB_read/s    kB_wrtn/s    kB_read    kB_wrtn</span><br><span class="line">scd0              0.00         0.00         0.00          0          0</span><br><span class="line">sdc               0.00         0.00         0.00          0          0</span><br><span class="line">sdb               0.00         0.00         0.00          0          0</span><br><span class="line">sda               0.00         0.00         0.00          0          0</span><br><span class="line">dm-0              0.00         0.00         0.00          0          0</span><br><span class="line">dm-1              0.00         0.00         0.00          0          0</span><br><span class="line">dm-2              0.00         0.00         0.00          0          0</span><br><span class="line"></span><br><span class="line"><span class="comment"># dm: device mapper, 如果分区时使用了LVM，则一般生成dm-N逻辑卷</span></span><br><span class="line"><span class="comment"># tps: 设备每秒的传输次数。&quot;一次传输&quot;指的是&quot;一次I/O请求&quot;。多个逻辑请求可能会被合并为&quot;一次I/O请求&quot;。&quot;一次传输&quot;请求的大小是未知的。</span></span><br><span class="line">kB_read/s：每秒从设备读取的数据量</span><br><span class="line">kB_wrtn/s：每秒从设备写入的数据量</span><br><span class="line">kB_read：读取的数据总量</span><br><span class="line">kB_wrtn：写入的总数据量；单位 Kilobytes</span><br></pre></td></tr></table></figure>

<p>示例</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">[root@Rocky8-mini ~]<span class="comment"># iostat -d sdb -t -k 1 2</span></span><br><span class="line">Linux 4.18.0-348.el8.0.2.x86_64 (Rocky8-mini) 	12/17/2022 	_x86_64_	(2 CPU)</span><br><span class="line"></span><br><span class="line">12/17/2022 09:39:47 PM</span><br><span class="line">Device             tps    kB_read/s    kB_wrtn/s    kB_read    kB_wrtn</span><br><span class="line">sdb               0.06         1.83         0.00       5727          2</span><br><span class="line"></span><br><span class="line">12/17/2022 09:39:48 PM</span><br><span class="line">Device             tps    kB_read/s    kB_wrtn/s    kB_read    kB_wrtn</span><br><span class="line">sdb               0.00         0.00         0.00          0          0</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[root@Rocky8-mini ~]<span class="comment"># iostat -d sdb -x</span></span><br><span class="line">Linux 4.18.0-348.el8.0.2.x86_64 (Rocky8-mini) 	12/17/2022 	_x86_64_	(2 CPU)</span><br><span class="line"></span><br><span class="line">Device            r/s     w/s     rkB/s     wkB/s   rrqm/s   wrqm/s  %rrqm  %wrqm r_await w_await aqu-sz rareq-sz wareq-sz  svctm  %util</span><br><span class="line">sdb              0.06    0.00      1.77      0.00     0.00     0.00   0.00   0.00    0.14    1.00   0.00    31.82     2.00   0.34   0.00</span><br><span class="line"></span><br><span class="line">r/s: 每秒合并后读的请求数</span><br><span class="line">w/s: 每秒合并后写的请求数</span><br><span class="line">rsec/s：每秒读取的扇区数；</span><br><span class="line">wsec/：每秒写入的扇区数。</span><br><span class="line">rKB/s：The number of <span class="built_in">read</span> requests that were issued to the device per second</span><br><span class="line">wKB/s：The number of write requests that were issued to the device per second</span><br><span class="line">rrqm/s：每秒这个设备相关的读取请求有多少被Merge了（当系统调用需要读取数据的时候，VFS将请求发到各个FS，如果FS发现不同的读取请求读取的是相同Block的数据，FS会将这个请求合并Merge）</span><br><span class="line">wrqm/s：每秒这个设备相关的写入请求有多少被Merge了</span><br><span class="line">%rrqm: The percentage of <span class="built_in">read</span> requests merged together before being sent to the device.</span><br><span class="line">%wrqm: The percentage of write requests merged together before being sent to the device.</span><br><span class="line">avgrq-sz 平均请求扇区的大小</span><br><span class="line">avgqu-sz 是平均请求队列的长度。毫无疑问，队列长度越短越好</span><br><span class="line">await： 每一个IO请求的处理的平均时间（单位是微秒毫秒）。这里可以理解为IO的响应时间，一般地系统IO响应时间应该低于5ms，如果大于10ms就比较大了。这个时间包括了队列时间和服务时间，也就是说，一般情况下，await大于svctm，它们的差值越小，则说明队列时间越短，反之差值越大，队列时间越长，说明系统出了问题</span><br><span class="line">svctm 表示平均每次设备I/O操作的服务时间（以毫秒为单位）。如果svctm的值与await很接近，表示几乎没有I/O等待，磁盘性能很好，如果await的值远高于svctm的值，则表示I/O队列等待太长，系统上运行的应用程序将变慢</span><br><span class="line">%util： 在统计时间内所有处理IO时间，除以总共统计时间。例如，如果统计间隔1秒，该设备有0.8秒在处理IO，而0.2秒闲置，那么该设备的%util = 0.8/1 = 80%，所以该参数暗示了设备的繁忙程度。一般地，如果该参数是100%表示设备已经接近满负荷运行了（当然如果是多磁盘，即使%util是100%，因为磁盘的并发能力，所以磁盘使用未必就到了瓶颈）</span><br></pre></td></tr></table></figure>

<h2 id="2-13-监视磁盘-I-x2F-O-iotop"><a href="#2-13-监视磁盘-I-x2F-O-iotop" class="headerlink" title="2.13 监视磁盘 I&#x2F;O iotop"></a>2.13 监视磁盘 I&#x2F;O iotop</h2><p>提供类似于top命令一般的UI界面，可查看每个进程是如何使用IO。来自于iotop包</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">[root@Rocky8-mini ~]<span class="comment"># iotop</span></span><br><span class="line"></span><br><span class="line">Total DISK READ :      51.17 K/s | Total DISK WRITE :     562.88 K/s</span><br><span class="line">Actual DISK READ:    1090.34 K/s | Actual DISK WRITE:       2.24 M/s</span><br><span class="line">    TID  PRIO  USER     DISK READ  DISK WRITE  SWAPIN     IO&gt;    COMMAND                                                                    </span><br><span class="line">   1685 be/7 root       51.17 K/s  562.88 K/s  0.00 %  0.09 % mandb -q</span><br><span class="line">      1 be/4 root        0.00 B/s    0.00 B/s  0.00 %  0.00 % systemd --switched-root --system --deserialize 18</span><br><span class="line">      2 be/4 root        0.00 B/s    0.00 B/s  0.00 %  0.00 % [kthreadd]</span><br><span class="line">      3 be/0 root        0.00 B/s    0.00 B/s  0.00 %  0.00 % [rcu_gp]</span><br><span class="line">      4 be/0 root        0.00 B/s    0.00 B/s  0.00 %  0.00 % [rcu_par_gp]</span><br><span class="line">      6 be/0 root        0.00 B/s    0.00 B/s  0.00 %  0.00 % [kworker/0:0H-events_highpri]</span><br><span class="line">      9 be/0 root        0.00 B/s    0.00 B/s  0.00 %  0.00 % [mm_percpu_wq]</span><br><span class="line">     10 be/4 root        0.00 B/s    0.00 B/s  0.00 %  0.00 % [ksoftirqd/0]</span><br><span class="line">     11 be/4 root        0.00 B/s    0.00 B/s  0.00 %  0.00 % [rcu_sched]</span><br><span class="line">     12 rt/4 root        0.00 B/s    0.00 B/s  0.00 %  0.00 % [migration/0]</span><br><span class="line">     13 rt/4 root        0.00 B/s    0.00 B/s  0.00 %  0.00 % [watchdog/0]</span><br><span class="line">     14 be/4 root        0.00 B/s    0.00 B/s  0.00 %  0.00 % [cpuhp/0]</span><br></pre></td></tr></table></figure>

<p>iotop 常用参数</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">OPTIONS</span><br><span class="line">--version</span><br><span class="line">Show the version number and <span class="built_in">exit</span></span><br><span class="line"></span><br><span class="line">-h, --<span class="built_in">help</span></span><br><span class="line">Show usage information and <span class="built_in">exit</span></span><br><span class="line"></span><br><span class="line">-o, --only</span><br><span class="line">Only show processes or threads actually doing I/O, instead of showing all processes or threads. This  can  be  dynamically toggled by pressing o.</span><br><span class="line"></span><br><span class="line">-b, --batch</span><br><span class="line">Turn on non-interactive mode.  Useful <span class="keyword">for</span> logging I/O usage over time.</span><br><span class="line"></span><br><span class="line">-n NUM, --iter=NUM</span><br><span class="line">Set the number of iterations before quitting (never quit by default).  This is most useful <span class="keyword">in</span> non-interactive mode.</span><br><span class="line"></span><br><span class="line">-d SEC, --delay=SEC</span><br><span class="line">Set the delay between iterations <span class="keyword">in</span> seconds (1 second by default).  Accepts non-integer values such as 1.1 seconds.</span><br><span class="line"></span><br><span class="line">-p PID, --pid=PID</span><br><span class="line">A list of processes/threads to monitor (all by default).</span><br><span class="line"></span><br><span class="line">-u USER, --user=USER</span><br><span class="line">A list of <span class="built_in">users</span> to monitor (all by default)</span><br><span class="line"></span><br><span class="line">-P, --processes</span><br><span class="line">Only show processes. Normally iotop shows all threads.</span><br><span class="line"></span><br><span class="line">-a, --accumulated</span><br><span class="line">Show  accumulated  I/O  instead  of bandwidth. In this mode, iotop shows the amount of I/O processes have <span class="keyword">done</span> since iotop started.</span><br><span class="line"></span><br><span class="line">-k, --kilobytes</span><br><span class="line">Use kilobytes instead of a human friendly unit. This mode is useful when scripting the batch mode  of  iotop.  Instead  of choosing the most appropriate unit iotop will display all sizes <span class="keyword">in</span> kilobytes.</span><br><span class="line"></span><br><span class="line">-t, --time</span><br><span class="line">Add a timestamp on each line (implies --batch). Each line will be prefixed by the current time.</span><br><span class="line"></span><br><span class="line">-q, --quiet</span><br><span class="line">suppress some lines of header (implies --batch). This option can be specified up to three <span class="built_in">times</span> to remove header lines.</span><br><span class="line">   -q     column names are only printed on the first iteration,</span><br><span class="line">   -qq    column names are never printed,</span><br><span class="line">   -qqq   the I/O summary is never printed.</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>交互按键</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">left 和 right 方向键: 改变排序</span><br><span class="line">r: 反向排序</span><br><span class="line">o: 切换至选项--only</span><br><span class="line">p: 切换至--processes选项</span><br><span class="line">a: 切换至--accumulate选项</span><br><span class="line">q: 退出</span><br><span class="line">i: 改变线程的优先级</span><br></pre></td></tr></table></figure>

<h2 id="2-14-显示网络带宽使用情况-iftop"><a href="#2-14-显示网络带宽使用情况-iftop" class="headerlink" title="2.14 显示网络带宽使用情况 iftop"></a>2.14 显示网络带宽使用情况 iftop</h2><p>来自于epel源的iftop包</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@Rocky8-mini ~]<span class="comment"># iftop</span></span><br><span class="line">interface: eth0</span><br><span class="line">IP address is: 192.168.119.128</span><br><span class="line">MAC address is: 00:0c:29:4d:a8:89</span><br></pre></td></tr></table></figure>

<p><img src="D:/Documents/TyporaPicture/%E8%BF%9B%E7%A8%8B%E5%92%8C%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1/image-20221218110425313.png" alt="image-20221218110425313"></p>
<h2 id="2-15-查看网络实时吞吐量-nload"><a href="#2-15-查看网络实时吞吐量-nload" class="headerlink" title="2.15 查看网络实时吞吐量 nload"></a>2.15 查看网络实时吞吐量 nload</h2><p>nload 是一个实时监控网络流量和带宽的使用情况，以数值和动态图展示进出的流量情况，通过epel源安装</p>
<p><img src="D:/Documents/TyporaPicture/%E8%BF%9B%E7%A8%8B%E5%92%8C%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1/image-20221218110810806.png" alt="image-20221218110810806"></p>
<p>界面操作</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">上下方向键、左右方向键、enter键或者tab键都就可以切换查看多个网卡的流量情况</span><br><span class="line">按 F2 显示选项窗口</span><br><span class="line">按 q 或者 Ctrl+C 退出 nload</span><br></pre></td></tr></table></figure>

<p>示例</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#默认只查看第一个网络的流量进出情况</span></span><br><span class="line">nload</span><br><span class="line"><span class="comment">#在nload后面指定网卡，可以指定多个,按左右键分别显示网卡状态</span></span><br><span class="line">nload eth0 eth1</span><br><span class="line"><span class="comment">#设置刷新间隔：默认刷新间隔是100毫秒，可通过 -t 命令设置刷新时间（单位是毫秒）</span></span><br><span class="line">nload -t 500 eth0</span><br><span class="line"><span class="comment">#设置单位：显示两种单位一种是显示Bit/s、一种是显示Byte/s，默认是以Bit/s，也可不显示/s</span></span><br><span class="line"><span class="comment">#-u h|b|k|m|g|H|B|K|M|G 表示的含义： h: auto, b: Bit/s, k: kBit/s, m: MBit/s, H:</span></span><br><span class="line">auto, B: Byte/s, K: kByte/s, M: MByte/s</span><br><span class="line">nload -u M eth0</span><br></pre></td></tr></table></figure>

<h2 id="2-16-网络监视工具-iptraf-ng"><a href="#2-16-网络监视工具-iptraf-ng" class="headerlink" title="2.16 网络监视工具 iptraf-ng"></a>2.16 网络监视工具 iptraf-ng</h2><p>来自于iptraf-ng包,可以对网络进行监控,对终端窗口大小有要求.</p>
<p><img src="D:/Documents/TyporaPicture/%E8%BF%9B%E7%A8%8B%E5%92%8C%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1/image-20221218112027899.png" alt="image-20221218112027899"></p>
<p><img src="D:/Documents/TyporaPicture/%E8%BF%9B%E7%A8%8B%E5%92%8C%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1/image-20221218112106679.png" alt="image-20221218112106679"></p>
<h2 id="2-17-系统资源统计-dstat"><a href="#2-17-系统资源统计-dstat" class="headerlink" title="2.17 系统资源统计 dstat"></a>2.17 系统资源统计 dstat</h2><p>dstat 由pcp-system-tools包提供，但安装dstat包即可, 可用于代替 vmstat,iostat功能</p>
<p>格式</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">dstat [-afv] [options..] [delay [count]]</span><br><span class="line"></span><br><span class="line">-c 显示cpu相关信息</span><br><span class="line">-C <span class="comment">#,#,...,total</span></span><br><span class="line">-d 显示disk相关信息</span><br><span class="line">-D total,sda,sdb,...</span><br><span class="line">-g 显示page相关统计数据</span><br><span class="line">-m 显示memory相关统计数据</span><br><span class="line">-n 显示network相关统计数据</span><br><span class="line">-p 显示process相关统计数据</span><br><span class="line">-r 显示io请求相关的统计数据</span><br><span class="line">-s 显示swapped相关的统计数据</span><br><span class="line">--tcp</span><br><span class="line">--udp</span><br><span class="line">--unix</span><br><span class="line">--raw</span><br><span class="line">--socket</span><br><span class="line">--ipc</span><br><span class="line">--top-cpu：显示最占用CPU的进程</span><br><span class="line">--top-io: 显示最占用io的进程</span><br><span class="line">--top-mem: 显示最占用内存的进程</span><br><span class="line">--top-latency: 显示延迟最大的进程</span><br></pre></td></tr></table></figure>

<p>示例</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[root@Rocky8-mini ~]<span class="comment"># dstat </span></span><br><span class="line">You did not select any stats, using -cdngy by default.</span><br><span class="line">----total-usage---- -dsk/total- -net/total- ---paging-- ---system--</span><br><span class="line">usr sys idl wai stl| <span class="built_in">read</span>  writ| recv  send|  <span class="keyword">in</span>   out | int   csw </span><br><span class="line">  0   0 100   0   0|   0     0 | 217B  890B|   0     0 | 115   191 </span><br><span class="line">  0   0  99   0   0|   0     0 | 218B  558B|   0     0 | 109   188 </span><br><span class="line">  0   0 100   0   0|   0     0 | 219B  568B|   0     0 | 107   164 </span><br><span class="line">  0   0  99   0   0|   0     0 | 218B  565B|   0     0 | 103   179 </span><br><span class="line">  0   1 100   0   0|   0  9406k| 218B  656B|   0     0 | 137   192 </span><br><span class="line">  0   0  99   0   0|   0     0 | 218B  583B|   0     0 | 127   195 </span><br><span class="line">  0   0 100   0   0|   0     0 | 217B  565B|   0     0 | 103   174 ^C</span><br></pre></td></tr></table></figure>

<h2 id="2-18-综合监控工具-glances"><a href="#2-18-综合监控工具-glances" class="headerlink" title="2.18 综合监控工具 glances"></a>2.18 综合监控工具 glances</h2><p>此工具可以通过EPEL源安装,可以监控其它主机的系统状态，不同版本之间不兼容</p>
<p>格式</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">glances [-bdehmnrsvyz1] [-B <span class="built_in">bind</span>] [-c server] [-C conffile] [-p port] [-P</span><br><span class="line">password] [--password] [-t refresh] [-f file] [-o output]</span><br></pre></td></tr></table></figure>

<p>内建命令</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">a Sort processes automatically              l Show/hide logs</span><br><span class="line">c Sort processes by CPU%                    b Bytes or bits <span class="keyword">for</span> network I/O</span><br><span class="line">m Sort processes by MEM%                    w Delete warning logs</span><br><span class="line">p Sort processes by name                    x Delete warning and critical logs</span><br><span class="line">i Sort processes by I/O rate                1 Global CPU or per-CPU stats</span><br><span class="line">d Show/hide disk I/O stats                  h Show/hide this <span class="built_in">help</span> screen</span><br><span class="line">f Show/hide file system stats               t View network I/O as combination</span><br><span class="line">n Show/hide network stats                   u View cumulative network I/O</span><br><span class="line">s Show/hide sensors stats                   q Quit (Esc and Ctrl-C also work)</span><br><span class="line">y Show/hide hddtemp stats</span><br></pre></td></tr></table></figure>

<p>常用选项</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">-b:  以Byte为单位显示网卡数据速率</span><br><span class="line">-d:  关闭磁盘I/O模块</span><br><span class="line">-f /path/to/somefile:  设定输入文件位置</span><br><span class="line">-o &#123;HTML|CSV&#125;:  输出格式</span><br><span class="line">-m:  禁用mount模块</span><br><span class="line">-n:  禁用网络模块</span><br><span class="line">-t <span class="comment">#:  延迟时间间隔</span></span><br><span class="line">-1:  每个CPU的相关数据单独显示</span><br></pre></td></tr></table></figure>

<p><strong>C&#x2F;S 模式下运行glances命令</strong></p>
<ul>
<li><p>服务器模式</p>
<p>  glances -s -B IPADDR</p>
<p>  ​    IPADDR：指明监听的本机哪个地址，默认端口为61209&#x2F;tcp</p>
</li>
<li><p>客户端模式</p>
<p>  glances -c IPADDR</p>
<p>  ​    IPADDR：要连入的服务器端地址</p>
</li>
</ul>
<p>示例</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 服务器打开监听地址和端口</span></span><br><span class="line">[root@Rocky8-mini ~]<span class="comment"># glances -s</span></span><br><span class="line">Glances XML-RPC server is running on 0.0.0.0:61209</span><br><span class="line"></span><br><span class="line"><span class="comment"># 客户端连接，查看连接的服务器的系统运行状况</span></span><br><span class="line">[root@Rocky8-mini2 ~]<span class="comment"># glances -c 192.168.119.128</span></span><br></pre></td></tr></table></figure>

<p><img src="D:/Documents/TyporaPicture/%E8%BF%9B%E7%A8%8B%E5%92%8C%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1/image-20221218144617071.png" alt="image-20221218144617071"></p>
<h2 id="2-19-查看进程打开文件-lsof"><a href="#2-19-查看进程打开文件-lsof" class="headerlink" title="2.19 查看进程打开文件 lsof"></a>2.19 查看进程打开文件 lsof</h2><p>lsof：list open files，查看当前系统文件的工具。在linux环境下，一切皆文件，用户通过文件不仅可以访问常规数据，还可以访问网络连接和硬件如传输控制协议 (TCP) 和用户数据报协议 (UDP)套接字等，系统在后台都为该应用程序分配了一个文件描述符</p>
<p>常用选项</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">-a：列出打开文件存在的进程</span><br><span class="line">-c&lt;进程名&gt;：列出指定进程所打开的文件</span><br><span class="line">-g：列出GID号进程详情</span><br><span class="line">-d&lt;文件号&gt;：列出占用该文件号的进程</span><br><span class="line">+d&lt;目录&gt;：列出目录下被打开的文件</span><br><span class="line">+D&lt;目录&gt;：递归列出目录下被打开的文件</span><br><span class="line">-n&lt;目录&gt;：列出使用NFS的文件</span><br><span class="line">-i&lt;条件&gt;：列出符合条件的进程(4、6、协议、:端口、 @ip )</span><br><span class="line">-p&lt;进程号&gt;：列出指定进程号所打开的文件</span><br><span class="line">-u：列出UID号进程详情</span><br><span class="line">-h：显示帮助信息</span><br><span class="line">-v：显示版本信息。</span><br><span class="line">-n: 不反向解析网络名字</span><br></pre></td></tr></table></figure>

<p>示例</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># lsof 列出当前所有打开的文件</span></span><br><span class="line">[root@Rocky8-mini ~]<span class="comment"># lsof</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看当前哪个进程正在使用此文件</span></span><br><span class="line">[root@Rocky8-mini ~]<span class="comment"># lsof /var/log/messages</span></span><br><span class="line">COMMAND   PID USER   FD   TYPE DEVICE SIZE/OFF     NODE NAME</span><br><span class="line">rsyslogd 1018 root    5w   REG  253,0   397817 34154191 /var/log/messages</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看由登录用户启动而非系统启动的进程</span></span><br><span class="line">lsof /dev/pts/0</span><br><span class="line">[root@Rocky8-mini ~]<span class="comment"># lsof `tty`</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 指定进程号，可以查看该进程打开的文件</span></span><br><span class="line">lsof -p PID</span><br><span class="line">[root@Rocky8-mini ~]<span class="comment"># lsof -p `pidof bc`</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看指定程序打开的文件</span></span><br><span class="line">[root@Rocky8-mini ~]<span class="comment"># lsof -c bc</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看指定用户打开的文件</span></span><br><span class="line">[root@Rocky8-mini ~]<span class="comment"># lsof -u root</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看指定目录下被打开的文件，参数+D为递归列出目录下被打开的文件；参数+d为列出目录下被打开的文件</span></span><br><span class="line">lsof +D /var/log/</span><br><span class="line">lsof +d /var/log/</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看所有网络连接，通过参数-i查看网络连接的情况，包括连接的ip、端口等，以及一些服务的连接情况。也可以通过指定ip查看该ip的网络连接情况</span></span><br><span class="line">lsof -i -n</span><br><span class="line">lsof -i@127.0.0.1</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看端口连接情况，通过&#x27;-i:PORT&#x27;可以查看端口的占用情况，-i 参数还可以查看协议、ip的连接情况等</span></span><br><span class="line">lsof -i:80 -n</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看指定进程打开的网络连接，参数-i 查看网络连接情况，-a 查看存在的进程，-p 指定进程号</span></span><br><span class="line">lsof -i -n -a -p 1593</span><br><span class="line"></span><br><span class="line"><span class="comment"># #查看指定状态的网络连接，-n:no host names, -P:no port names,-i TCP指定协议，-s指定协议状态通过多个参数可以清晰的查看网络连接情况、协议连接情况等</span></span><br><span class="line">lsof -n -P -i TCP -s TCP:ESTABLISHED</span><br></pre></td></tr></table></figure>

<p>实例：利用 lsof 恢复正在使用中的误删除的文件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@Rocky8-mini ~]<span class="comment"># rm -f file.txt</span></span><br><span class="line">[root@Rocky8-mini ~]<span class="comment"># lsof | grep file.txt</span></span><br><span class="line">vim       16943                   root    6u      REG              253,0    12288   51002071 /root/.file.txt.swp</span><br><span class="line">[root@Rocky8-mini ~]<span class="comment"># cat /proc/16943/fd/6 &gt; file.txt</span></span><br></pre></td></tr></table></figure>

<h2 id="2-22-信号发送-kill"><a href="#2-22-信号发送-kill" class="headerlink" title="2.22 信号发送 kill"></a>2.22 信号发送 kill</h2><p>kill：内部命令，向进程发送控制信号，实现对进程的管理，每个信号对应一个数字，信号名称以SIG开头，不区分大小写</p>
<p>显示当前系统可用信号</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">kill</span> -l</span><br><span class="line"><span class="built_in">trap</span> -l</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看帮助</span></span><br><span class="line">man 7 signal</span><br></pre></td></tr></table></figure>

<p>常用信号</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">1) SIGHUP    无须关闭进程而让其重读配置文件</span><br><span class="line">2) SIGINT    中止正在运行的进程，相当于ctrl+c</span><br><span class="line">3) SIGQUIT   相当于ctrl+\</span><br><span class="line">4) SIGKILL   强制杀死正在运行的进程，可能会导致数据丢失</span><br><span class="line">15) SIGTERM  终止正在运行的进程，默认信号</span><br><span class="line">18) SIGCONT  继续运行</span><br><span class="line">19) SIGSTOP  后台休眠</span><br><span class="line"></span><br><span class="line"><span class="comment"># 指定信号的三种方式</span></span><br><span class="line">- 信号的数字表示：1,2,9</span><br><span class="line">- 信号的完整名称：SIGHUP/sighup</span><br><span class="line">- 信号的简写名称：HUP/hup</span><br><span class="line"></span><br><span class="line">注：许多服务支持的reload操作，实际就是发送了HUP信号</span><br></pre></td></tr></table></figure>

<p>向进程发送信号：</p>
<ul>
<li>按照 PID</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">kill</span> [-signal|-s signal|-p] [-q value] [-a] [--] pid|name...</span><br><span class="line"><span class="built_in">kill</span> -l [number] | -L</span><br></pre></td></tr></table></figure>

<p>示例</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">kill</span> -1 pid ...</span><br><span class="line"><span class="built_in">kill</span> -n 9 pid</span><br><span class="line"><span class="built_in">kill</span> -s SIGINT pid</span><br><span class="line">[root@centos7 ~]<span class="comment"># kill -term `pidof ping`</span></span><br><span class="line">[root@centos7 ~]<span class="comment"># kill -sigterm `pidof ping`</span></span><br></pre></td></tr></table></figure>

<ul>
<li>按照名称，killall 来自于psmisc包</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">killall - <span class="built_in">kill</span> processes by name</span><br><span class="line">killall [-SIGNAL] <span class="built_in">command</span>...</span><br><span class="line"></span><br><span class="line">[root@Rocky8-mini ~]<span class="comment"># killall -TERM ping</span></span><br></pre></td></tr></table></figure>

<ul>
<li>按照模式</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">pkill [options] pattern</span><br><span class="line"></span><br><span class="line">[options]</span><br><span class="line">-SIGNAL</span><br><span class="line">-u uid: effective user, 生效者</span><br><span class="line">-U uid: real user, 真正发起运行命令的用户</span><br><span class="line">-t terminal: 与指定终端相关的进程</span><br><span class="line">-l: 显示进程名 (pgrep 可用)</span><br><span class="line">-a: 显示完整格式的进程名 (pgrep 可用)</span><br><span class="line">-P pid: 显示指定进程的子进程</span><br></pre></td></tr></table></figure>

<p>示例：利用 0 信号实现进程的健康性检查</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[root@Rocky8-mini ~]<span class="comment"># man kill</span></span><br><span class="line">If signal is 0, <span class="keyword">then</span> no actual signal is sent, but error checking is still performed.</span><br><span class="line"></span><br><span class="line">[root@Rocky8-mini ~]<span class="comment"># killall -0 ping</span></span><br><span class="line">[root@Rocky8-mini ~]<span class="comment"># echo $?</span></span><br><span class="line">0</span><br><span class="line">[root@Rocky8-mini ~]<span class="comment"># killall -0 ping</span></span><br><span class="line">ping: no process found</span><br><span class="line">[root@Rocky8-mini ~]<span class="comment"># echo $?</span></span><br><span class="line">1</span><br><span class="line"></span><br><span class="line"><span class="comment"># 此方式有局限性，即使进程处于停止或僵尸状态，也会认为进程是健康的</span></span><br></pre></td></tr></table></figure>

<p>示例：pkill 和 pgrep支持正则表达式</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@Rocky8-mini ~]<span class="comment"># pgrep -a &#x27;^p&#x27;</span></span><br><span class="line">950 /usr/lib/polkit-1/polkitd --no-debug</span><br><span class="line">2229 ping www.baidu.com</span><br><span class="line"></span><br><span class="line">[root@Rocky8-mini ~]<span class="comment"># pkill &#x27;^p&#x27;</span></span><br></pre></td></tr></table></figure>

<h2 id="2-23-作业管理"><a href="#2-23-作业管理" class="headerlink" title="2.23 作业管理"></a>2.23 作业管理</h2><p>Linux 的作业控制</p>
<ul>
<li>前台作业：通过终端启动，且启动后一直占据终端</li>
<li>后台作业：可通过终端启动，但启动后转入后台运行</li>
</ul>
<p>让作业运行于后台</p>
<ul>
<li>运行中的作业：Ctrl + z</li>
<li>尚未启动的作业：COMMAND &amp;</li>
</ul>
<p>后台作业虽然被送往后台运行，但依然与终端相关；退出终端，将关闭后台作业。如果希望送往后台作业剥离与终端的关系，执行以下方法：</p>
<ul>
<li>nohup COMMMAND &amp;&gt; &#x2F;dev&#x2F;null &amp;</li>
<li>screen; COMMAND</li>
<li>tmux; COMMAND</li>
</ul>
<p>查看当前终端所有作业：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">jobs</span></span><br></pre></td></tr></table></figure>

<p>作业控制</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">fg</span> [[%]JOB_NUM]:  把指定的后台作业调回前台</span><br><span class="line"><span class="built_in">bg</span> [[%]JOB_NUM]:  让送往后台的作业在后台继续运行</span><br><span class="line"><span class="built_in">kill</span> [%JOB_NUM]:  终止指定的作业</span><br></pre></td></tr></table></figure>

<p>示例：后台运行的进程和终端的关系</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 终端1中运行后台进程</span></span><br><span class="line">[root@Rocky8-mini ~]<span class="comment"># ping 127.0.0.1 &amp;</span></span><br><span class="line">[1] 2270</span><br><span class="line"></span><br><span class="line"><span class="comment"># 终端2中可以查看到进程</span></span><br><span class="line">[root@Rocky8-mini ~]<span class="comment"># ps aux | grep ping</span></span><br><span class="line">root        2270  0.0  0.1  32460  2316 pts/1    S    22:16   0:00 ping 127.0.0.1</span><br><span class="line">root        2272  0.0  0.0  12136  1032 pts/0    S+   22:19   0:00 grep --color=auto ping</span><br><span class="line"></span><br><span class="line"><span class="comment"># 关闭终端1，终端2将查看不到进程</span></span><br><span class="line">[root@Rocky8-mini ~]<span class="comment"># ps aux | grep ping</span></span><br><span class="line">root        2278  0.0  0.0  12136  1156 pts/0    S+   22:20   0:00 grep --color=auto ping</span><br></pre></td></tr></table></figure>

<p>示例：nohup</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">[root@Rocky8-mini ~]<span class="comment"># rpm -qf `which nohup`</span></span><br><span class="line">coreutils-8.30-12.el8.x86_64</span><br><span class="line"></span><br><span class="line">[root@Rocky8-mini ~]<span class="comment"># nohup ping 127.0.0.1</span></span><br><span class="line"><span class="built_in">nohup</span>: ignoring input and appending output to <span class="string">&#x27;nohup.out&#x27;</span></span><br><span class="line"></span><br><span class="line">[root@Rocky8-mini ~]<span class="comment"># tail -f nohup.out</span></span><br><span class="line">64 bytes from 127.0.0.1: icmp_seq=34 ttl=64 time=0.030 ms</span><br><span class="line">64 bytes from 127.0.0.1: icmp_seq=35 ttl=64 time=0.040 ms</span><br><span class="line">64 bytes from 127.0.0.1: icmp_seq=36 ttl=64 time=0.032 ms</span><br><span class="line">64 bytes from 127.0.0.1: icmp_seq=37 ttl=64 time=0.029 ms</span><br><span class="line"></span><br><span class="line">[root@Rocky8-mini ~]<span class="comment"># nohup ping 127.0.0.1 &amp;&gt; /dev/null &amp;</span></span><br><span class="line">[1] 2345</span><br><span class="line">[root@Rocky8-mini ~]<span class="comment"># ps aux | grep nohup</span></span><br><span class="line">root        2353  0.0  0.0  12136  1124 pts/0    S+   22:35   0:00 grep --color=auto <span class="built_in">nohup</span></span><br><span class="line">[root@Rocky8-mini ~]<span class="comment"># pstree -p |grep ping</span></span><br><span class="line">           |-sshd(968)-+-sshd(1511)---sshd(1523)---bash(1524)---ping(2345)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 关闭对应的终端，再观察进程的父进程</span></span><br><span class="line">[root@Rocky8-mini ~]<span class="comment"># pstree -p |grep ping</span></span><br><span class="line">           |-ping(2345)</span><br></pre></td></tr></table></figure>

<h2 id="2-24-并行运行"><a href="#2-24-并行运行" class="headerlink" title="2.24 并行运行"></a>2.24 并行运行</h2><p>利用后台执行，实现并行功能，即同时运行多个进程，提高效率</p>
<p>方式一</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> all.sh</span><br><span class="line">f1.sh&amp;</span><br><span class="line">f2.sh&amp;</span><br><span class="line">f3.sh&amp;</span><br></pre></td></tr></table></figure>

<p>方式二</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(f1.sh&amp;);(f2.sh&amp;);(f3.sh&amp;)</span><br></pre></td></tr></table></figure>

<p>方式三</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">f1.sh&amp;f2.sh&amp;f3.sh&amp;</span><br></pre></td></tr></table></figure>

<p>示例：多组命令实现并行</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123; ping -c3 127.1; ping 127.2; &#125;&amp; &#123; ping -c3 127.3; ping 127.4; &#125;&amp;</span><br></pre></td></tr></table></figure>

<p>示例</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@Rocky8-mini ~]<span class="comment"># cat test.sh </span></span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line">net=192.168.0</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> &#123;100..110&#125;;<span class="keyword">do</span></span><br><span class="line">	&#123; ping -c1 -w1 <span class="variable">$&#123;net&#125;</span>.<span class="variable">$&#123;i&#125;</span> &amp;&gt; /dev/null &amp;&amp; <span class="built_in">echo</span> <span class="variable">$&#123;net&#125;</span>.<span class="variable">$&#123;i&#125;</span> is up || <span class="built_in">echo</span> <span class="variable">$&#123;net&#125;</span>.<span class="variable">$&#123;i&#125;</span> is <span class="keyword">done</span>; &#125;&amp;</span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="built_in">wait</span></span><br></pre></td></tr></table></figure>

<h1 id="三、任务计划"><a href="#三、任务计划" class="headerlink" title="三、任务计划"></a>三、任务计划</h1><p>通过任务计划，让系统自动的按时间或周期性执行任务，需要先实现邮件通知</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@Rocky8-mini ~]<span class="comment"># dnf -y install postfix</span></span><br><span class="line">[root@Rocky8-mini ~]<span class="comment"># systemctl enable --now postfix.service</span></span><br></pre></td></tr></table></figure>

<p>未来的某一个时间点执行一次任务</p>
<ul>
<li>at          指定时间点，执行一次任务</li>
<li>batch    系统自行选择空闲时间去执行指定的任务</li>
</ul>
<p>周期性运行任务</p>
<ul>
<li>cron</li>
</ul>
<h2 id="3-1-一次性任务"><a href="#3-1-一次性任务" class="headerlink" title="3.1 一次性任务"></a>3.1 一次性任务</h2><p>at 工具</p>
<ul>
<li>由包 at 提供</li>
<li>依赖于 atd 服务，需要启动才能实现 at 任务</li>
<li>at 队列存放在 &#x2F;var&#x2F;spool&#x2F;at 目录中，Ubuntu 存放在 &#x2F;var&#x2F;spool&#x2F;cron&#x2F;atjobs 目录下</li>
<li>执行任务时PATH变量的值和当前定义任务的用户身份一致</li>
</ul>
<p>at 命令</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">at [option] TIME</span><br><span class="line"></span><br><span class="line">-V  显示版本信息</span><br><span class="line">-t time  时间格式 [[CC]YY]MMDDhhmm[.ss]</span><br><span class="line">-l  列出指定队列中等待运行的作业，相当于atq</span><br><span class="line">-d N  删除指定的N号作业；相当于atrm</span><br><span class="line">-c N  查看具体作业N号任务</span><br><span class="line">-f file  指定的文件中读取任务</span><br><span class="line">-m  当任务被完成之后，将给用户发送邮件，即使没有标准输出</span><br><span class="line"></span><br><span class="line">注意：作业执行命令的结果中的标准输出和错误以执行任务的用户身份发邮件通知给root；默认8中的最小化安装没有安装邮件服务器，需要自行安装</span><br></pre></td></tr></table></figure>

<p>TIME：定义什么时候进行 at 这项任务的时间</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">HH:MM [YYYY-mm-dd]</span><br><span class="line">noon, midnight, teatime(4pm), tomorrow</span><br><span class="line">now+<span class="comment">#&#123;mintes,hours,days, OR weeks&#125;</span></span><br></pre></td></tr></table></figure>

<p>示例：at 时间格式</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">HH:MM  在今日的 HH:MM 进行,若该时刻已过，则明天此时执行任务</span><br><span class="line"></span><br><span class="line">HH:MM YYYY-MM-DD  规定在某年某月的某一天的特殊时刻进行该项任务</span><br><span class="line"></span><br><span class="line">HH:MM[am|pm] [Month] [Date]</span><br><span class="line">06pm March 17</span><br><span class="line">17:20 tomorrow</span><br><span class="line"></span><br><span class="line">HH:MM[am|pm] + number [minutes|hours|days|weeks],在某个时间点再加几个时间后才进行该项任务</span><br><span class="line">now + 5 min</span><br><span class="line">02pm + 3 day</span><br></pre></td></tr></table></figure>

<p>at 任务执行方式</p>
<ul>
<li>交互式</li>
<li>输入重定向</li>
<li>at -f file</li>
</ul>
<p>&#x2F;etc&#x2F;at.{allow,deny} 控制用户能否执行 at 任务</p>
<ul>
<li>白名单：&#x2F;etc&#x2F;at.allow 默认不存在，只有该文件中的用户才能执行 at 命令</li>
<li>黑名单：&#x2F;etc&#x2F;at.deny 默认存在，拒绝该文件中用户执行 at 命令，而没有在此文件中则可以使用</li>
<li>如果两个文件都不存在，只有root可以执行 at 命令</li>
</ul>
<p>示例：Ubuntu at 任务存放路径</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">root@ubuntu18-server:~<span class="comment"># ll /var/spool/cron/</span></span><br><span class="line">total 20</span><br><span class="line">drwxr-xr-x 5 root   root    4096 Sep 15  2021 ./</span><br><span class="line">drwxr-xr-x 4 root   root    4096 Sep 15  2021 ../</span><br><span class="line">drwxrwx--T 2 daemon daemon  4096 Sep 15  2021 atjobs/</span><br><span class="line">drwxrwx--T 2 daemon daemon  4096 Feb 20  2018 atspool/</span><br><span class="line">drwx-wx--T 2 root   crontab 4096 Nov 16  2017 crontabs/</span><br><span class="line">root@ubuntu18-server:~<span class="comment"># ll /var/spool/cron/atjobs/</span></span><br><span class="line">total 12</span><br><span class="line">drwxrwx--T 2 daemon daemon 4096 Sep 15  2021 ./</span><br><span class="line">drwxr-xr-x 5 root   root   4096 Sep 15  2021 ../</span><br><span class="line">-rw------- 1 daemon daemon    2 Sep 15  2021 .SEQ</span><br></pre></td></tr></table></figure>

<h2 id="3-2-周期性计划任务-cron"><a href="#3-2-周期性计划任务-cron" class="headerlink" title="3.2 周期性计划任务 cron"></a>3.2 周期性计划任务 cron</h2><p>周期性计划任务cron相关的程序包</p>
<ul>
<li>cronie：主程序包，提供crond守护进程及相关辅助工具</li>
<li>crontabs：包含为Centos提供系统维护任务</li>
<li>cronie-anacron：cronie 的补充程序，用户监控cronie任务执行状况。如：cronie 中的任务在某一个时间点该运行的任务没有正常运行，则anacron会随后启动一次此任务</li>
</ul>
<p>cron 依赖于crond服务，确保crond守护处于运行状态</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl status crond.service</span><br></pre></td></tr></table></figure>

<p>cron 任务划分</p>
<ul>
<li>系统cron任务：系统维护作业，主配置文件<code>/etc/crontab</code>, 子配置文件<code>/etc/cron.d</code></li>
<li>用户cron任务：保存在<code>/var/spool/cron/USERNAME</code>(Ubuntu 系统存放在<code>/var/spool/cron/crontabs/USERNAME</code>)，利用crontab命令管理</li>
</ul>
<p>计划任务日志：<code>/var/log/cron</code></p>
<h3 id="3-2-1-系统cron计划任务"><a href="#3-2-1-系统cron计划任务" class="headerlink" title="3.2.1 系统cron计划任务"></a>3.2.1 系统cron计划任务</h3><p>格式说明：<code>/etc/crontab</code>，crontab 命令使用：<code>man 5 crontab</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[root@Rocky8-mini ~]<span class="comment"># cat /etc/crontab </span></span><br><span class="line">SHELL=/bin/bash                           <span class="comment"># 默认的shell类型</span></span><br><span class="line">PATH=/sbin:/bin:/usr/sbin:/usr/bin        <span class="comment"># 默认PATH变量，可修改</span></span><br><span class="line">MAILTO=root                               <span class="comment"># 默认标准输出和错误发邮件给root，可修改</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># For details see man 4 crontabs</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Example of job definition:</span></span><br><span class="line"><span class="comment"># .---------------- minute (0 - 59)</span></span><br><span class="line"><span class="comment"># |  .------------- hour (0 - 23)</span></span><br><span class="line"><span class="comment"># |  |  .---------- day of month (1 - 31)</span></span><br><span class="line"><span class="comment"># |  |  |  .------- month (1 - 12) OR jan,feb,mar,apr ...</span></span><br><span class="line"><span class="comment"># |  |  |  |  .---- day of week (0 - 6) (Sunday=0 or 7) OR sun,mon,tue,wed,thu,fri,sat</span></span><br><span class="line"><span class="comment"># |  |  |  |  |</span></span><br><span class="line"><span class="comment"># *  *  *  *  * user-name  command to be executed</span></span><br></pre></td></tr></table></figure>

<p>计划任务的简单示例</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 每隔5分钟执行一次命令</span></span><br><span class="line">*/5 * * * * <span class="built_in">ls</span> /tmp</span><br><span class="line"></span><br><span class="line"><span class="comment"># 每月的1号，4号，6号的2点整执行</span></span><br><span class="line">0 2 1,4,6 * * <span class="built_in">ls</span> /tmp</span><br><span class="line"></span><br><span class="line"><span class="comment"># 每月每日每小时的0分就执行</span></span><br><span class="line">0 * * * * <span class="built_in">ls</span> /tmp</span><br><span class="line"></span><br><span class="line"><span class="comment"># 每分钟执行一次命令</span></span><br><span class="line">* * * * * <span class="built_in">ls</span> /tmp</span><br><span class="line"></span><br><span class="line"><span class="comment"># 每周五的2点整执行（当不写日和月的时间时，仅周有效）</span></span><br><span class="line">0 2 * * 5 <span class="built_in">ls</span> /tmp</span><br><span class="line"></span><br><span class="line"><span class="comment"># 6月3日的5点10分执行或6月的每周日的5点10分执行</span></span><br><span class="line">10 5 3 6 0 /usr/bin/touch /mnt/file1-`<span class="built_in">date</span> +\%F_\%T`</span><br><span class="line"><span class="comment"># 每个月的3日的5点10分或者每周日的5点10分执行</span></span><br><span class="line">10 5 3 * 0 /usr/bin/touch /data/file-`<span class="built_in">date</span> +\%F_\%T`</span><br></pre></td></tr></table></figure>

<p>帮助手册</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[root@wh-ctyun ~]<span class="comment"># man 5 crontab</span></span><br><span class="line">The time and <span class="built_in">date</span> fields are:</span><br><span class="line"></span><br><span class="line">              field          allowed values</span><br><span class="line">              -----          --------------</span><br><span class="line">              minute         0-59</span><br><span class="line">              hour           0-23</span><br><span class="line">              day of month   1-31</span><br><span class="line">              month          1-12 (or names, see below)</span><br><span class="line">              day of week    0-7 (0 or 7 is Sunday, or use names)</span><br><span class="line">              </span><br><span class="line">Note: The day of a <span class="built_in">command</span><span class="string">&#x27;s execution can be specified in the following two fields — &#x27;</span>day of month<span class="string">&#x27;, and &#x27;</span>day of  week<span class="string">&#x27;.   If  both  fields  are  restricted (i.e., do not contain the &quot;*&quot; character), the command will be run when either field matches the current time.  For example, &quot;30 4 1,15 * 5&quot; would cause a command to be run at 4:30 am on the 1st and 15th of each month, plus every Friday.              </span></span><br></pre></td></tr></table></figure>

<h3 id="3-2-2-用户计划任务"><a href="#3-2-2-用户计划任务" class="headerlink" title="3.2.2 用户计划任务"></a>3.2.2 用户计划任务</h3><p>crontab 命令</p>
<ul>
<li>每个用户都有自己的cron任务文件：<code>/var/spool/cron/USERNAME</code></li>
<li>默认标准输出和错误输出会被发邮件给对应的用户</li>
<li>root 用户能够修改其它用户的作业</li>
<li>用户的cron中默认的PATH&#x3D;&#x2F;usr&#x2F;bin:&#x2F;bin，如果使用其它路径，在任务文件中添加PATH</li>
</ul>
<p>crontab 命令格式</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">crontab [-u user] [-l | -r | -e ] [-i]</span><br><span class="line"></span><br><span class="line">常用选项:</span><br><span class="line">-l    列出所有任务</span><br><span class="line">-e    编辑任务</span><br><span class="line">-r    移除所有任务</span><br><span class="line">-i    同-r一同使用，以交互式模式移除指定任务</span><br><span class="line">-u user    指定用户管理cron任务，仅root可运行</span><br></pre></td></tr></table></figure>

<p>控制用户执行计划任务：<code>/etc/cron.&#123;allow,deny&#125;</code></p>
<p>示例：关于计划任务中的PATH变量</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 方法1，直接指定PATH</span></span><br><span class="line">PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/root/bin</span><br><span class="line"></span><br><span class="line"><span class="comment"># 方法2，在书写命令时写全该命令的路径</span></span><br><span class="line">[root@wh-ctyun ~]<span class="comment"># crontab -l</span></span><br><span class="line">10 5 3 6 * /usr/bin/touch /mnt/file-`<span class="built_in">date</span> +\%F_\%T`</span><br></pre></td></tr></table></figure>

<p>在cron任务中不建议使用%，其表示换行的特殊用途，且第一个%后的所有字符串会被当成命令的标准输入，如果在命令中需要使用到%，则需要使用到 \ 进行转义。</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="https://wuhaolam.github.io">Wu Hao</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://wuhaolam.github.io/archives/ea4fbed9.html">https://wuhaolam.github.io/archives/ea4fbed9.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="external nofollow noreferrer" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://wuhaolam.github.io" target="_blank">穿着草鞋前往</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Linux%E5%9F%BA%E7%A1%80/">Linux基础</a></div><div class="post_share"><div class="social-share" data-image="https://cdn.jsdelivr.net/gh/wuhaolam/picgo_demo/img/%E5%A4%B4%E5%83%8F.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/archives/7ca84884.html" title="自签名CA证书并颁发应用证书"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">自签名CA证书并颁发应用证书</div></div></a></div><div class="next-post pull-right"><a href="/archives/f82bde29.html" title="网卡名修改和静态IP地址配置"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">网卡名修改和静态IP地址配置</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/archives/c31ae19.html" title="Linux基础入门和帮助"><img class="cover" src="https://cdn.jsdelivr.net/gh/wuhaolam/picgo_demo/img/rockyLinux.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-08-14</div><div class="title">Linux基础入门和帮助</div></div></a></div><div><a href="/archives/c871820f.html" title="文件查找和打包压缩"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-10-11</div><div class="title">文件查找和打包压缩</div></div></a></div><div><a href="/archives/8b87eef8.html" title="文本处理三剑客"><img class="cover" src="https://cdn.jsdelivr.net/gh/wuhaolam/picgo_demo/img/grep-sed-awk.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-08-17</div><div class="title">文本处理三剑客</div></div></a></div><div><a href="/archives/c5a7de75.html" title="Shell 脚本编程"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-09-25</div><div class="title">Shell 脚本编程</div></div></a></div><div><a href="/archives/bd60744f.html" title="文本处理工具与正则表达式"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-08-17</div><div class="title">文本处理工具与正则表达式</div></div></a></div><div><a href="/archives/50005d9f.html" title="磁盘存储和文件系统管理"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-11-06</div><div class="title">磁盘存储和文件系统管理</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="lv-container" data-id="city" data-uid="MTAyMC81NzA1My8zMzUxNw=="></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://cdn.jsdelivr.net/gh/wuhaolam/picgo_demo/img/%E5%A4%B4%E5%83%8F.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Wu Hao</div><div class="author-info__description">欢迎来到吴浩的博客！</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">29</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">8</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">8</div></a></div><a id="card-info-btn" target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/wuhaolam/" rel="external nofollow noreferrer" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:wuhaolam@foxmail.com" rel="external nofollow noreferrer" target="_blank" title="Email"><i class="fas fa-envelope"></i></a><a class="social-icon" href="https://weibo.com/u/6551419807" rel="external nofollow noreferrer" target="_blank" title="微博"><i class="fa-brands fa-weibo"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">个人博客，仅供参考学习。</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E8%BF%9B%E7%A8%8B%E5%92%8C%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86"><span class="toc-text">一、进程和内存管理</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-1-%E4%BB%80%E4%B9%88%E6%98%AF%E8%BF%9B%E7%A8%8B"><span class="toc-text">1.1 什么是进程</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-2-%E8%BF%9B%E7%A8%8B%E3%80%81%E7%BA%BF%E7%A8%8B%E5%92%8C%E6%90%BA%E7%A8%8B"><span class="toc-text">1.2 进程、线程和携程</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-1-%E8%BF%9B%E7%A8%8B"><span class="toc-text">1.2.1 进程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-2-%E7%BA%BF%E7%A8%8B"><span class="toc-text">1.2.2 线程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-3-%E5%8D%8F%E7%A8%8B"><span class="toc-text">1.2.3 协程</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-3-%E8%BF%9B%E7%A8%8B%E4%BC%98%E5%85%88%E7%BA%A7"><span class="toc-text">1.3 进程优先级</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E8%BF%9B%E7%A8%8B%E7%AE%A1%E7%90%86%E5%92%8C%E6%80%A7%E8%83%BD%E7%9B%B8%E5%85%B3%E5%B7%A5%E5%85%B7"><span class="toc-text">二、进程管理和性能相关工具</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#2-1-%E8%BF%9B%E7%A8%8B%E6%A0%91-pstree"><span class="toc-text">2.1 进程树 pstree</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-2-%E8%BF%9B%E7%A8%8B%E4%BF%A1%E6%81%AF-ps"><span class="toc-text">2.2 进程信息 ps</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-3-%E6%9F%A5%E7%9C%8B%E8%BF%9B%E7%A8%8B%E4%BF%A1%E6%81%AF-prtstat"><span class="toc-text">2.3 查看进程信息 prtstat</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-4-%E8%AE%BE%E7%BD%AE%E5%92%8C%E8%B0%83%E6%95%B4%E8%BF%9B%E7%A8%8B%E4%BC%98%E5%85%88%E7%BA%A7"><span class="toc-text">2.4 设置和调整进程优先级</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-5-%E6%90%9C%E7%B4%A2%E8%BF%9B%E7%A8%8B"><span class="toc-text">2.5 搜索进程</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-5-1-pgrep"><span class="toc-text">2.5.1 pgrep</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-5-2-pidof"><span class="toc-text">2.5.2 pidof</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-6-%E8%B4%9F%E8%BD%BD%E6%9F%A5%E8%AF%A2-uptime"><span class="toc-text">2.6 负载查询 uptime</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-7-%E6%98%BE%E7%A4%BACPU%E7%9B%B8%E5%85%B3%E7%BB%9F%E8%AE%A1-mpstat"><span class="toc-text">2.7 显示CPU相关统计 mpstat</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-8-%E6%9F%A5%E7%9C%8B%E8%BF%9B%E7%A8%8B%E5%AE%9E%E6%97%B6%E7%8A%B6%E6%80%81-top-%E5%92%8C-htop"><span class="toc-text">2.8 查看进程实时状态 top 和 htop</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-8-1-top"><span class="toc-text">2.8.1 top</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-8-2-htop"><span class="toc-text">2.8.2 htop</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-9-%E5%86%85%E5%AD%98%E7%A9%BA%E9%97%B4-free"><span class="toc-text">2.9 内存空间 free</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-10-%E8%BF%9B%E7%A8%8B%E5%AF%B9%E5%BA%94%E7%9A%84%E5%86%85%E5%AD%98%E6%98%A0%E5%B0%84-pmap"><span class="toc-text">2.10 进程对应的内存映射 pmap</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-11-%E8%99%9A%E6%8B%9F%E5%86%85%E5%AD%98%E4%BF%A1%E6%81%AF-vmstat"><span class="toc-text">2.11 虚拟内存信息 vmstat</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-12-%E7%BB%9F%E8%AE%A1CPU%E5%92%8C%E8%AE%BE%E5%A4%87IO%E4%BF%A1%E6%81%AF-iostat"><span class="toc-text">2.12 统计CPU和设备IO信息 iostat</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-13-%E7%9B%91%E8%A7%86%E7%A3%81%E7%9B%98-I-x2F-O-iotop"><span class="toc-text">2.13 监视磁盘 I&#x2F;O iotop</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-14-%E6%98%BE%E7%A4%BA%E7%BD%91%E7%BB%9C%E5%B8%A6%E5%AE%BD%E4%BD%BF%E7%94%A8%E6%83%85%E5%86%B5-iftop"><span class="toc-text">2.14 显示网络带宽使用情况 iftop</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-15-%E6%9F%A5%E7%9C%8B%E7%BD%91%E7%BB%9C%E5%AE%9E%E6%97%B6%E5%90%9E%E5%90%90%E9%87%8F-nload"><span class="toc-text">2.15 查看网络实时吞吐量 nload</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-16-%E7%BD%91%E7%BB%9C%E7%9B%91%E8%A7%86%E5%B7%A5%E5%85%B7-iptraf-ng"><span class="toc-text">2.16 网络监视工具 iptraf-ng</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-17-%E7%B3%BB%E7%BB%9F%E8%B5%84%E6%BA%90%E7%BB%9F%E8%AE%A1-dstat"><span class="toc-text">2.17 系统资源统计 dstat</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-18-%E7%BB%BC%E5%90%88%E7%9B%91%E6%8E%A7%E5%B7%A5%E5%85%B7-glances"><span class="toc-text">2.18 综合监控工具 glances</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-19-%E6%9F%A5%E7%9C%8B%E8%BF%9B%E7%A8%8B%E6%89%93%E5%BC%80%E6%96%87%E4%BB%B6-lsof"><span class="toc-text">2.19 查看进程打开文件 lsof</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-22-%E4%BF%A1%E5%8F%B7%E5%8F%91%E9%80%81-kill"><span class="toc-text">2.22 信号发送 kill</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-23-%E4%BD%9C%E4%B8%9A%E7%AE%A1%E7%90%86"><span class="toc-text">2.23 作业管理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-24-%E5%B9%B6%E8%A1%8C%E8%BF%90%E8%A1%8C"><span class="toc-text">2.24 并行运行</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E4%BB%BB%E5%8A%A1%E8%AE%A1%E5%88%92"><span class="toc-text">三、任务计划</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#3-1-%E4%B8%80%E6%AC%A1%E6%80%A7%E4%BB%BB%E5%8A%A1"><span class="toc-text">3.1 一次性任务</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-2-%E5%91%A8%E6%9C%9F%E6%80%A7%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1-cron"><span class="toc-text">3.2 周期性计划任务 cron</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-1-%E7%B3%BB%E7%BB%9Fcron%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1"><span class="toc-text">3.2.1 系统cron计划任务</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-2-%E7%94%A8%E6%88%B7%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1"><span class="toc-text">3.2.2 用户计划任务</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/archives/f5066d4c.html" title="基于 centos 构建 Tomcat 的业务镜像">基于 centos 构建 Tomcat 的业务镜像</a><time datetime="2023-12-13T01:22:00.000Z" title="发表于 2023-12-13 09:22:00">2023-12-13</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/archives/d69bc2fb.html" title="基于 alpine 构建 nginx 的业务镜像">基于 alpine 构建 nginx 的业务镜像</a><time datetime="2023-12-08T01:22:00.000Z" title="发表于 2023-12-08 09:22:00">2023-12-08</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/archives/99c33715.html" title="二进制安装 docker22.04">二进制安装 docker22.04</a><time datetime="2023-12-06T01:22:00.000Z" title="发表于 2023-12-06 09:22:00">2023-12-06</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/archives/229c053b.html" title="二进制安装 Containerd1.7.2">二进制安装 Containerd1.7.2</a><time datetime="2023-12-06T01:22:00.000Z" title="发表于 2023-12-06 09:22:00">2023-12-06</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/archives/945a5bc5.html" title="基于 ubuntu 构建 nginx 的业务镜像">基于 ubuntu 构建 nginx 的业务镜像</a><time datetime="2023-11-29T01:22:00.000Z" title="发表于 2023-11-29 09:22:00">2023-11-29</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2022 - 2024 By Wu Hao</div><div class="footer_custom_text"><div><a onclick="window.open('https://beian.miit.gov.cn')">皖ICP备2023003329号</a></div></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>function loadLivere () {
  if (typeof LivereTower === 'object') {
    window.LivereTower.init()
  }
  else {
    (function(d, s) {
        var j, e = d.getElementsByTagName(s)[0];
        if (typeof LivereTower === 'function') { return; }
        j = d.createElement(s);
        j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
        j.async = true;
        e.parentNode.insertBefore(j, e);
    })(document, 'script');
  }
}

if ('Livere' === 'Livere' || !false) {
  if (false) btf.loadComment(document.getElementById('lv-container'), loadLivere)
  else loadLivere()
}
else {
  function loadOtherComment () {
    loadLivere()
  }
}</script></div><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-nest.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {

  // removeEventListener scroll 
  window.tocScrollFn && window.removeEventListener('scroll', window.tocScrollFn)
  window.scrollCollect && window.removeEventListener('scroll', scrollCollect)

  document.getElementById('rightside').style.cssText = "opacity: ''; transform: ''"
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')

  typeof disqusjs === 'object' && disqusjs.destroy()
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof chatBtnFn === 'function' && chatBtnFn()
  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', (e) => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>